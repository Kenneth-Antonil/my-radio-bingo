<!DOCTYPE html>
<html lang="tl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Radio Bingo Live | Summer Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd"></script>

    <style>
        /* === SUMMER VIBE PALETTE (CLEANED UP) === */
        :root { 
            --bg-overlay: rgba(15, 23, 42, 0.92); 
            --glass-surface: rgba(30, 41, 59, 0.85);
            --glass-border: rgba(255, 255, 255, 0.15);
            
            --accent: #0ea5e9; /* Ocean Blue */
            --accent-glow: #38bdf8;
            --text: #ffffff; 
            --gold: #fbbf24; 
            --gold-shine: #fcd34d;
            --success: #10b981; 
            --danger: #ef4444; 
            --bringme: #8b5cf6; 
            --minigame: #f472b6; 
            
            /* SWEET BONANZA THEME COLORS */
            --sb-bg-top: #6db3f2;
            --sb-bg-bot: #ffb6c1;
            --sb-glass: rgba(255, 255, 255, 0.25);
            --sb-border: rgba(255, 255, 255, 0.6);
        }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { 
            font-family: 'Inter', sans-serif; 
            background: url('https://images.unsplash.com/photo-1614094723477-e5ecb7274ae8?q=80&w=2576&auto=format&fit=crop') no-repeat center center fixed;
            background-size: cover;
            color: var(--text); 
            margin: 0; 
            padding-bottom: 30px; 
            overflow-x: hidden; 
            min-height: 100vh;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.8);
        }

        /* === SHINY GLASSMORPHISM STYLES === */
        .glass-panel {
            background: var(--glass-surface);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
        }

        /* BANNER STYLES */
        #jackpotBanner { 
            background: linear-gradient(90deg, #f59e0b, #fbbf24, #f59e0b); 
            color: #451a03; 
            text-shadow: none; 
            padding: 12px; 
            text-align: center; 
            font-weight: 900; 
            font-size: 15px; 
            text-transform: uppercase; 
            letter-spacing: 1px; 
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.6); 
            animation: shimmer 2s infinite linear; 
            background-size: 200% auto; 
            display: none; 
            margin-bottom: 15px; 
            border: 2px solid #fff;
        }
        @keyframes shimmer { to { background-position: 200% center; } }
        .jackpot-amount { font-size: 20px; color: #451a03; display: block; font-weight: 900; }

        /* LOGIN STYLES */
        #loginOverlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 9999; display: flex; align-items: center; justify-content: center; padding: 20px; backdrop-filter: blur(8px); }
        .login-card { background: rgba(30, 41, 59, 0.95); backdrop-filter: blur(20px); padding: 50px 30px; border-radius: 40px; width: 100%; max-width: 400px; text-align: center; border: 1px solid rgba(255,255,255,0.2); box-shadow: 0 25px 50px rgba(0,0,0,0.8); }
        .login-logo { font-size: 42px; font-weight: 900; margin-bottom: 10px; letter-spacing: -2px; text-shadow: 0 4px 10px rgba(0,0,0,0.5); background: -webkit-linear-gradient(#fff, #cbd5e1); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .login-logo span { background: -webkit-linear-gradient(#38bdf8, #0ea5e9); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .login-sub { font-size: 15px; opacity: 1; color: #e2e8f0; margin-bottom: 35px; line-height: 1.6; font-weight: 600; text-shadow: 0 2px 4px black; }
        .btn-google { background: white; color: #000; border: none; width: 100%; padding: 16px; border-radius: 16px; font-weight: 800; display: flex; align-items: center; justify-content: center; gap: 12px; cursor: pointer; font-size: 16px; transition: 0.3s; box-shadow: 0 10px 20px rgba(0,0,0,0.2); text-shadow: none; }
        .btn-google:hover { transform: translateY(-2px); box-shadow: 0 15px 25px rgba(255,255,255,0.2); }
        
        /* NAVBAR & PROFILE */
        .nav { 
            background: rgba(15, 23, 42, 0.95); 
            backdrop-filter: blur(15px);
            padding: 10px 15px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 100; border-bottom: 1px solid rgba(255,255,255,0.1); height: auto; min-height: 60px;
        }
        .user-stats { display: flex; align-items: center; gap: 8px; }
        .icon-btn { background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.15); width: 38px; height: 38px; border-radius: 12px; cursor: pointer; position: relative; display: flex; align-items: center; justify-content: center; transition: 0.2s; }
        .icon-btn:active { transform: scale(0.95); }
        .notif-badge { position: absolute; top: 8px; right: 8px; background: var(--danger); width: 8px; height: 8px; border-radius: 50%; border: 1px solid var(--surface); display: none; z-index: 10; box-shadow: 0 0 10px var(--danger); }
        .points-badge { background: linear-gradient(135deg, rgba(251, 191, 36, 0.2), rgba(245, 158, 11, 0.4)); color: #fff; padding: 0 12px; height: 38px; border-radius: 12px; font-weight: 800; border: 1px solid rgba(251, 191, 36, 0.6); font-size: 13px; cursor: pointer; display: flex; align-items: center; gap: 6px; text-shadow: 0 1px 2px rgba(0,0,0,0.8); box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3); }
        
        #userImg {
            width: 45px; height: 45px; border-radius: 50%; /* Circular */
            cursor: pointer; border: 2px solid var(--accent); 
            object-fit: cover; box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .disclaimer { background: rgba(239, 68, 68, 1); color: white; padding: 6px 0; font-size: 10px; font-weight: 700; overflow: hidden; white-space: nowrap; border-bottom: 1px solid rgba(255,255,255,0.2); backdrop-filter: blur(5px); text-shadow: 0 1px 2px black; }
        .marquee-content { display: inline-block; animation: marquee 25s linear infinite; padding-left: 100%; }
        @keyframes marquee { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }
        
        /* NOTES & SOCIAL */
        .notes-container-bg { background: rgba(15, 23, 42, 0.5); backdrop-filter: blur(10px); padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1); margin-bottom: 15px; }
        .notes-wrapper { display: flex; gap: 15px; overflow-x: auto; padding: 0 15px; scrollbar-width: none; align-items: flex-start; }
        .notes-wrapper::-webkit-scrollbar { display: none; }
        .note-item { display: flex; flex-direction: column; align-items: center; min-width: 70px; position: relative; cursor: pointer; transition: 0.2s; }
        .note-item:active { transform: scale(0.95); opacity: 0.8; }
        .note-avatar-box { position: relative; width: 64px; height: 64px; border-radius: 50%; border: 2px solid var(--accent); padding: 3px; margin-bottom: 5px; }
        .note-avatar-box img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; }
        .online-status-dot { position: absolute; bottom: 2px; right: 2px; width: 14px; height: 14px; background: #10b981; border: 2px solid #1e293b; border-radius: 50%; z-index: 5; box-shadow: 0 0 10px #10b981; animation: pulse-green 2s infinite; }
        @keyframes pulse-green { 0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); } 70% { transform: scale(1); box-shadow: 0 0 0 6px rgba(16, 185, 129, 0); } 100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); } }
        .note-bubble { position: absolute; top: -5px; right: -10px; background: white; color: black; padding: 2px 6px; border-radius: 8px; font-size: 9px; font-weight: 800; max-width: 75px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; box-shadow: 0 3px 8px rgba(0,0,0,0.3); border: 1px solid rgba(0,0,0,0.1); animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 6; }
        .note-name { font-size: 11px; margin-top: 2px; opacity: 0.9; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px; text-shadow: 0 1px 2px black; }
        .add-note-btn { width: 64px; height: 64px; border-radius: 50%; background: rgba(255,255,255,0.1); border: 1px dashed rgba(255,255,255,0.5); display: flex; align-items: center; justify-content: center; color: white; font-size: 24px; cursor: pointer; margin-bottom: 5px; }

        /* TABS */
        .tab-system { display: flex; background: rgba(0,0,0,0.6); margin: 0 0 15px 0; border-radius: 18px; padding: 5px; gap: 5px; border: 1px solid rgba(255,255,255,0.1); }
        .tab-btn { flex: 1; padding: 12px; border: none; background: transparent; color: #cbd5e1; font-weight: 800; font-size: 12px; cursor: pointer; border-radius: 12px; transition: 0.3s; display: flex; align-items: center; justify-content: center; gap: 8px; text-shadow: 0 1px 2px black; }
        .tab-btn.active { background: rgba(255,255,255,0.2); color: white; box-shadow: 0 4px 15px rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.3); text-shadow: 0 0 10px rgba(255,255,255,0.5); }
        .tab-btn.active.bringme-tab { background: rgba(139, 92, 246, 0.3); color: white; border-color: rgba(139, 92, 246, 0.6); }
        .tab-btn.active.minigame-tab { background: rgba(236, 72, 153, 0.3); color: white; border-color: rgba(236, 72, 153, 0.6); }

        /* BRING ME STYLES */
        .bringme-content { display: none; background: linear-gradient(180deg, rgba(46, 16, 101, 0.9) 0%, rgba(11, 17, 32, 0.95) 100%); border: 2px solid var(--bringme); border-radius: 25px; overflow: hidden; position: relative; backdrop-filter: blur(10px); }
        .bringme-header-ai { background: var(--bringme); color: white; padding: 10px; text-align: center; font-weight: 900; font-size: 12px; letter-spacing: 1px; display: flex; align-items: center; justify-content: center; gap: 8px; box-shadow: 0 5px 20px rgba(139, 92, 246, 0.4); }
        .bringme-status { text-align: center; padding: 30px 20px; position: relative; }
        .bringme-target { font-size: 32px; font-weight: 900; color: white; margin: 15px 0; text-transform: uppercase; letter-spacing: 2px; text-shadow: 0 0 20px rgba(139, 92, 246, 1); }
        .bringme-desc { font-size: 15px; color: #e9d5ff; margin-bottom: 25px; font-weight: 700; text-shadow: 0 2px 4px black; }
        .ai-camera-container { position: relative; width: 100%; max-width: 320px; aspect-ratio: 1; margin: 0 auto 20px; border-radius: 20px; border: 2px dashed var(--bringme); display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.6); overflow: hidden; box-shadow: inset 0 0 30px rgba(0,0,0,0.5); }
        .ai-camera-container img { width: 100%; height: 100%; object-fit: cover; display: none; }
        .ai-placeholder { text-align: center; opacity: 0.8; color: white; }
        .btn-upload-advanced { background: linear-gradient(135deg, var(--bringme), #7c3aed); color: white; border: none; padding: 18px 30px; border-radius: 20px; font-weight: 900; cursor: pointer; width: 100%; display: flex; align-items: center; justify-content: center; gap: 12px; font-size: 16px; transition: 0.3s; box-shadow: 0 10px 25px rgba(139, 92, 246, 0.4), inset 0 1px 0 rgba(255,255,255,0.2); text-shadow: 0 1px 2px black; }
        .btn-upload-advanced:active { transform: scale(0.98); }
        .ai-scanning-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 5px; background: #fff; box-shadow: 0 0 15px #fff, 0 0 30px var(--bringme); animation: scanLine 2s linear infinite; display: none; z-index: 10; }
        @keyframes scanLine { 0% { top: 0%; } 50% { top: 100%; } 100% { top: 0%; } }

        /* BINGO GRID & UI */
        .next-draw-container { background: rgba(15, 23, 42, 0.8); border: 1px solid rgba(251, 191, 36, 0.4); padding: 15px; border-radius: 20px; margin-bottom: 15px; display: none; align-items: center; gap: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); backdrop-filter: blur(10px); }
        .nd-icon { background: linear-gradient(135deg, rgba(251, 191, 36, 0.2), rgba(245, 158, 11, 0.2)); color: var(--gold); width: 45px; height: 45px; border-radius: 12px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; border: 1px solid rgba(251, 191, 36, 0.4); }
        .nd-info { flex: 1; }
        .next-draw-label { font-size: 11px; font-weight: 800; color: var(--gold); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 2px; }
        .next-draw-time { font-size: 18px; font-weight: 900; color: white; text-shadow: 0 2px 5px rgba(0,0,0,0.8); }
        .container { width: 100%; max-width: 500px; margin: 0 auto; padding: 10px; }
        .card { background: var(--glass-surface); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border-radius: 24px; padding: 20px; margin-bottom: 20px; border: 1px solid var(--glass-border); position: relative; transition: all 0.3s ease; box-shadow: 0 15px 35px rgba(0,0,0,0.4); }
        .video-feed-wrapper { margin-bottom: 15px; border-radius: 24px; overflow: hidden; background: #000; border: 2px solid rgba(255,255,255,0.2); box-shadow: 0 10px 40px rgba(0,0,0,0.6); }
        .video-container { position: relative; height: 220px; width: 100%; }
        .video-overlay-bl { position: absolute; bottom: 12px; left: 12px; z-index: 10; background: rgba(0,0,0,0.9); padding: 6px 12px; border-radius: 8px; border: 1px solid var(--success); display: flex; align-items: center; gap: 5px; color: var(--success); font-size: 11px; font-weight: 800; }
        .draw-panel { display: grid; grid-template-columns: 1fr 90px; gap: 12px; margin-bottom: 20px; }
        .prev-balls { background: rgba(0,0,0,0.4); border-radius: 16px; padding: 10px; display: flex; align-items: center; gap: 8px; overflow-x: auto; scrollbar-width: none; border: 1px solid rgba(255,255,255,0.1); }
        .ball-small { min-width: 40px; height: 40px; background: linear-gradient(135deg, #334155, #1e293b); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 900; border: 1px solid rgba(255,255,255,0.3); color: white; box-shadow: 0 4px 10px rgba(0,0,0,0.3); text-shadow: 0 1px 2px black; }
        .current-ball-box { background: linear-gradient(135deg, var(--accent), #2563eb); border-radius: 18px; height: 90px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: 0 8px 25px rgba(59, 130, 246, 0.5); border: 2px solid rgba(255,255,255,0.4); position: relative; overflow: hidden; }
        .bingo-header { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin-bottom: 10px; }
        .letter { text-align: center; font-size: 26px; font-weight: 900; color: var(--gold); text-shadow: 0 2px 10px rgba(251, 191, 36, 0.8); -webkit-text-stroke: 1px rgba(0,0,0,0.5); }
        .grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; position: relative; }
        .cell { aspect-ratio: 1; background: rgba(255,255,255,0.1); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 18px; border: 1px solid rgba(255,255,255,0.15); transition: all 0.3s; z-index: 2; position: relative; overflow: hidden; box-shadow: inset 0 2px 5px rgba(255,255,255,0.05); color: white; text-shadow: 0 2px 3px black; }
        .cell.hit { background: linear-gradient(135deg, var(--accent), #2563eb); color: white; transform: scale(1.05); border-color: rgba(255,255,255,0.6); box-shadow: 0 5px 15px rgba(59, 130, 246, 0.6); text-shadow: 0 2px 2px rgba(0,0,0,0.5); }
        .cell.win-glow { background: #10b981 !important; color: white; z-index: 3; border: 2px solid #fff; box-shadow: 0 0 25px var(--success), inset 0 0 15px rgba(255,255,255,0.3); animation: popWin 0.4s ease forwards; }

        /* WINNING LINES & MODALS */
        .late-overlay, .game-over-overlay { position: absolute; inset: 0; background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); z-index: 100; display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 20px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.2); }
        #winnerBanner { display: none; background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 15px; border-radius: 16px; text-align: center; font-weight: 900; margin-bottom: 15px; animation: slideDown 0.5s ease; border: 2px solid #a7f3d0; box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4); text-shadow: 0 1px 2px rgba(0,0,0,0.5); }
        @keyframes slideDown { from { transform: translateY(-10px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        /* CHAT STYLES */
        .chat-box { height: 450px; display: flex; flex-direction: column; background: var(--glass-surface); border-radius: 24px; border: 1px solid var(--glass-border); overflow: hidden; box-shadow: 0 15px 40px rgba(0,0,0,0.6); backdrop-filter: blur(20px); }
        .chat-header { padding: 15px 20px; background: rgba(255,255,255,0.05); border-bottom: 1px solid rgba(255,255,255,0.1); display: flex; align-items: center; gap: 10px; }
        .chat-header h3 { margin: 0; font-size: 15px; font-weight: 800; letter-spacing: 0.5px; }
        #chatList { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 18px; scroll-behavior: smooth; }
        #chatList::-webkit-scrollbar { width: 5px; }
        #chatList::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 10px; }
        .chat-row { display: flex; gap: 12px; max-width: 95%; position: relative; animation: fadeIn 0.3s ease; }
        .chat-pfp { width: 38px; height: 38px; border-radius: 14px; border: 2px solid var(--accent); flex-shrink: 0; object-fit: cover; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .chat-content { flex: 1; }
        .bubble { background: rgba(255,255,255,0.1); padding: 12px 16px; border-radius: 0 20px 20px 20px; border: 1px solid rgba(255,255,255,0.1); position: relative; box-shadow: 0 2px 5px rgba(0,0,0,0.2); backdrop-filter: blur(5px); }
        .chat-name { font-size: 12px; font-weight: 800; color: var(--accent-glow); margin-bottom: 4px; display: flex; align-items: center; gap: 6px; text-shadow: 0 0 10px rgba(56, 189, 248, 0.6); cursor:pointer; }
        .chat-text { font-size: 13.5px; line-height: 1.5; color: #ffffff; word-break: break-word; text-shadow: 0 1px 2px black; font-weight: 500; }
        .chat-input-area { background: rgba(0,0,0,0.3); padding: 15px; border-top: 1px solid rgba(255,255,255,0.1); }
        .input-wrapper { display: flex; gap: 10px; background: rgba(15, 23, 42, 0.8); padding: 6px 6px 6px 15px; border-radius: 18px; border: 1px solid rgba(255,255,255,0.2); transition: 0.3s; box-shadow: inset 0 2px 5px rgba(0,0,0,0.4); }
        .input-wrapper input { flex: 1; background: none; border: none; color: white; outline: none; font-size: 14px; height: 42px; text-shadow: none; font-weight: 500; }
        .send-btn { background: linear-gradient(135deg, var(--accent), #2563eb); color: white; border: none; width: 42px; height: 42px; border-radius: 14px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: 0.2s; box-shadow: 0 4px 10px rgba(59, 130, 246, 0.3); }

        /* MODALS */
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 1000; display: none; align-items: center; justify-content: center; padding: 15px; backdrop-filter: blur(15px); }
        .modal-content { background: rgba(30, 41, 59, 0.95); border-radius: 30px; width: 100%; max-width: 450px; padding: 25px; border: 1px solid rgba(255,255,255,0.2); max-height: 90vh; overflow-y: auto; box-shadow: 0 25px 60px rgba(0,0,0,0.8); }

        /* MINIGAMES LOBBY */
        .minigame-lobby { display: grid; grid-template-columns: 1fr; gap: 15px; padding: 10px 0; }
        .game-poster { 
            position: relative; height: 180px; border-radius: 24px; overflow: hidden; 
            cursor: pointer; border: 1px solid rgba(255,255,255,0.3); 
            transition: transform 0.3s, box-shadow 0.3s;
            background-size: cover; background-position: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .game-poster:hover { transform: scale(1.03); box-shadow: 0 20px 40px rgba(0,0,0,0.7); border-color: var(--minigame); }
        .poster-content { 
            position: absolute; bottom: 0; left: 0; right: 0; padding: 20px;
            background: linear-gradient(0deg, rgba(0,0,0,0.95) 0%, rgba(0,0,0,0) 100%);
        }
        .poster-title { font-size: 22px; font-weight: 900; color: white; text-transform: uppercase; letter-spacing: 1px; text-shadow: 0 2px 10px black; }
        .poster-desc { font-size: 12px; color: #cbd5e1; font-weight: 500; opacity: 1; text-shadow: 0 1px 2px black; }
        .poster-play { 
            position: absolute; top: 15px; right: 15px; background: white; color: black; 
            padding: 6px 14px; border-radius: 20px; font-size: 11px; font-weight: 900; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.3); transform: rotate(5deg);
        }

        /* === UNIVERSAL GAME OVERLAY === */
        .game-overlay-fs {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at center, #1e1b4b, #0f172a); 
            z-index: 2000; display: none; flex-direction: column;
            overflow-y: auto; padding: 20px;
            backdrop-filter: blur(20px);
            animation: fadeInFs 0.4s ease;
        }
        @keyframes fadeInFs { from{opacity:0;} to{opacity:1;} }
        .go-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .go-back-btn { background: rgba(255,255,255,0.15); border: 1px solid rgba(255,255,255,0.2); color: white; padding: 10px 20px; border-radius: 12px; font-weight: 800; display: flex; align-items: center; gap: 8px; cursor: pointer; transition: 0.2s; backdrop-filter: blur(5px); }
        
        /* === CANDY SMASH 1000 (Sweet Bonanza Clone) STYLES === */
        #game-bonanza {
            background: url('https://images.unsplash.com/photo-1579546929518-9e396f3cc809?q=80&w=2670&auto=format&fit=crop') no-repeat center center fixed;
            background-size: cover;
        }

        .bonanza-container {
            width: 100%; max-width: 500px; margin: 0 auto;
            display: flex; flex-direction: column; align-items: center; gap: 15px;
        }

        .bonanza-header-ui {
            display: flex; justify-content: space-between; width: 100%; gap: 10px;
        }

        .b-feature-buy {
            background: linear-gradient(180deg, #f472b6, #db2777);
            border: 2px solid #fbcfe8; border-radius: 12px;
            padding: 10px; flex: 1; text-align: center;
            box-shadow: 0 5px 0 #be185d, 0 10px 20px rgba(0,0,0,0.3);
            cursor: not-allowed; opacity: 0.8;
            transform: scale(0.95);
        }
        .b-feature-text { font-size: 10px; font-weight: 900; color: white; display: block; text-transform: uppercase; text-shadow: 0 1px 2px rgba(0,0,0,0.5); }
        .b-feature-cost { font-size: 14px; font-weight: 900; color: #fff; }

        .b-bet-panel {
            background: linear-gradient(180deg, #4ade80, #16a34a);
            border: 2px solid #bbf7d0; border-radius: 12px;
            padding: 10px; flex: 1; text-align: center;
            box-shadow: 0 5px 0 #15803d, 0 10px 20px rgba(0,0,0,0.3);
        }

        .bonanza-grid-frame {
            background: rgba(255, 255, 255, 0.4);
            padding: 15px; border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 4px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 20px 60px rgba(0,0,0,0.3), inset 0 0 30px rgba(255,255,255,0.2);
            position: relative;
        }
        /* Candy Cane Border Effect */
        .bonanza-grid-frame::before {
            content: ''; position: absolute; inset: -8px; border-radius: 28px;
            border: 4px dashed #f472b6; z-index: -1;
            pointer-events: none; opacity: 0.8;
        }

        .bonanza-grid {
            display: grid; 
            grid-template-columns: repeat(6, 1fr); 
            gap: 6px;
        }

        .b-cell {
            width: 50px; height: 50px;
            background: rgba(255, 255, 255, 0.25);
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 28px;
            box-shadow: inset 0 2px 5px rgba(255,255,255,0.4);
            border: 1px solid rgba(255,255,255,0.3);
            transition: transform 0.2s;
            position: relative;
        }

        .b-symbol {
            filter: drop-shadow(0 4px 2px rgba(0,0,0,0.3));
            animation: bounceIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 2;
        }
        
        .b-cell.b-win {
            background: #fcd34d;
            animation: pulseWin 0.5s infinite alternate;
            z-index: 5;
        }
        
        @keyframes bounceIn { 
            0% { transform: scale(0); opacity: 0; } 
            60% { transform: scale(1.2); opacity: 1; } 
            100% { transform: scale(1); } 
        }
        @keyframes pulseWin { from { box-shadow: 0 0 10px #fcd34d; } to { box-shadow: 0 0 25px #fbbf24; transform: scale(1.1); } }
        @keyframes fallDown { from { transform: translateY(-50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        
        .b-pop-text {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            color: #fff; font-weight: 900; font-size: 16px;
            text-shadow: 0 2px 0 #000, -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;
            z-index: 10; pointer-events: none;
            animation: floatUp 1s forwards;
        }
        @keyframes floatUp { 0% { opacity: 1; transform: translate(-50%, -50%) scale(0.5); } 100% { opacity: 0; transform: translate(-50%, -150%) scale(1.5); } }

        .b-controls {
            display: flex; align-items: center; justify-content: space-between;
            width: 100%; background: rgba(0,0,0,0.5); border-radius: 50px;
            padding: 8px 15px; border: 2px solid rgba(255,255,255,0.2);
            margin-top: 10px; backdrop-filter: blur(10px);
        }
        
        .b-spin-btn {
            width: 70px; height: 70px; border-radius: 50%;
            background: transparent; border: 4px solid white;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; position: relative; margin-left: auto;
            transition: 0.2s; box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }
        .b-spin-btn::before {
            content:''; position:absolute; inset: 4px; border-radius: 50%;
            background: transparent; border: 3px solid rgba(255,255,255,0.5);
        }
        .b-spin-btn i { color: white; width: 35px; height: 35px; }
        .b-spin-btn:active { transform: scale(0.9); background: rgba(255,255,255,0.1); }
        .b-spin-btn.disabled { opacity: 0.5; cursor: not-allowed; animation: spinInfinite 1s linear infinite; }
        @keyframes spinInfinite { 100% { transform: rotate(360deg); } }

        .b-info-box { color: white; font-weight: 800; font-size: 14px; text-shadow: 0 1px 2px black; }
        .b-win-display { font-size: 24px; color: #fbbf24; font-weight: 900; text-shadow: 0 2px 10px rgba(0,0,0,0.8); }

        /* === OLD GAMES POLISH (Unified Style) === */
        /* Slots Frame Update */
        .slot-machine-frame {
            background: linear-gradient(135deg, #fcd34d, #b45309, #fcd34d); /* Gold Metallic */
            padding: 25px; border-radius: 35px; border: 2px solid #fff;
            box-shadow: 
                inset 0 0 30px rgba(0,0,0,0.5), 
                0 30px 60px rgba(0,0,0,0.6),
                0 0 0 6px #78350f;
            position: relative; max-width: 400px; margin: 0 auto;
        }
        .slot-window {
            background: #000; padding: 12px; border-radius: 18px;
            display: flex; gap: 10px; border: 4px solid #451a03;
            box-shadow: inset 0 0 30px rgba(0,0,0,0.9);
            margin-bottom: 25px; overflow: hidden; height: 140px; align-items: center; justify-content: center;
            position: relative;
        }
        .reel-col { 
            flex: 1; height: 110px; background: linear-gradient(to bottom, #f1f5f9, #cbd5e1, #f1f5f9); border-radius: 10px; 
            display: flex; align-items: center; justify-content: center; 
            font-size: 52px; position: relative; overflow: hidden;
            box-shadow: inset 0 0 15px rgba(0,0,0,0.2), 0 0 5px rgba(0,0,0,0.5);
            border: 1px solid #94a3b8;
        }
        .slot-lever-btn {
            background: linear-gradient(180deg, #ef4444, #b91c1c);
            width: 100%; padding: 22px; border: none; border-radius: 18px;
            color: white; font-weight: 900; font-size: 22px; text-transform: uppercase;
            box-shadow: 0 8px 0 #7f1d1d, 0 15px 30px rgba(0,0,0,0.4), inset 0 2px 0 rgba(255,255,255,0.3);
            cursor: pointer; transition: 0.1s; position: relative; text-shadow: 0 2px 2px rgba(0,0,0,0.3);
        }
        .slot-lever-btn:active { transform: translateY(5px); box-shadow: 0 3px 0 #7f1d1d, 0 5px 10px rgba(0,0,0,0.4); }

        /* Unified Win Modal */
        .result-modal {
            position: absolute; inset: 0; background: rgba(0,0,0,0.85);
            display: none; align-items: center; justify-content: center;
            flex-direction: column; z-index: 50; border-radius: 30px;
            backdrop-filter: blur(8px); animation: fadeIn 0.3s;
        }
        .res-title { font-size: 38px; font-weight: 900; margin-bottom: 5px; text-transform: uppercase; letter-spacing: 1px; }
        .res-win { color: #fbbf24; text-shadow: 0 0 30px #fbbf24; }
        .res-loss { color: #ef4444; text-shadow: 0 0 20px rgba(239, 68, 68, 0.5); }
        .btn-play-again {
            background: white; color: black; border: none; padding: 12px 25px; 
            border-radius: 30px; font-weight: 900; font-size: 12px; cursor: pointer;
            box-shadow: 0 0 20px rgba(255,255,255,0.3); transition: 0.2s; margin-top: 15px;
        }

        /* Roulette & High Low Refinements */
        .roulette-table { background: radial-gradient(circle, #065f46, #064e3b); padding: 35px; border-radius: 40px; border: 6px solid #b45309; box-shadow: 0 30px 60px rgba(0,0,0,0.6); display: flex; flex-direction: column; align-items: center; }
        .wheel-outer { width: 280px; height: 280px; background: #451a03; border-radius: 50%; display: flex; align-items: center; justify-content: center; position: relative; border: 5px solid #b45309; }
        .wheel-inner { width: 250px; height: 250px; border-radius: 50%; background: conic-gradient(#dc2626 0deg 36deg, #171717 36deg 72deg, #dc2626 72deg 108deg, #171717 108deg 144deg, #dc2626 144deg 180deg, #171717 180deg 216deg, #dc2626 216deg 252deg, #171717 252deg 288deg, #dc2626 288deg 324deg, #171717 324deg 360deg); transition: transform 3s cubic-bezier(0.15, 0.85, 0.15, 1); }
        .roulette-ball { width: 14px; height: 14px; background: white; border-radius: 50%; position: absolute; top: 12px; left: 50%; transform: translateX(-50%); box-shadow: 0 0 8px white; }

        .hl-table { background: radial-gradient(circle, #1e3a8a, #0f172a); padding: 40px 20px; border-radius: 35px; text-align: center; border: 4px solid rgba(255,255,255,0.1); }
        .playing-card { width: 150px; height: 220px; background: white; border-radius: 18px; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; font-size: 56px; color: black; font-weight: 900; position: relative; box-shadow: 0 20px 40px rgba(0,0,0,0.5); }
        .btn-guess { padding: 18px; border-radius: 18px; border: none; font-weight: 800; cursor: pointer; color: white; width: 45%; }
        .bg-hi { background: linear-gradient(135deg, #10b981, #059669); }
        .bg-lo { background: linear-gradient(135deg, #ef4444, #b91c1c); }

    </style>
</head>
<body>

<div id="loginOverlay">
    <div class="login-card">
        <div class="login-logo">RADIO<span>BINGO</span></div>
        <p class="login-sub">Welcome to the official live stream bingo.</p>
        <button class="btn-google" onclick="login()">
            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/action/google.svg" alt="Google" style="width:18px">
            Sign in with Google
        </button>
    </div>
</div>

<div class="nav">
    <div style="display:flex; align-items:center;"><span style="font-weight: 900; font-size: 20px; text-shadow: 0 2px 5px rgba(0,0,0,0.8);">RADIO<span style="color:var(--accent-glow)">BINGO</span></span></div>
    <div id="userPanel" style="display:none; align-items: center; gap: 10px;">
        <div class="user-stats">
            <div class="points-badge" onclick="document.getElementById('storeModal').style.display='flex'"><i data-lucide="coins" style="width:18px"></i> <span id="userPoints">0</span></div>
        </div>
        <img id="userImg" onclick="document.getElementById('menuModal').style.display='flex'" src="">
    </div>
</div>

<div class="disclaimer"><div class="marquee-content">‚ö†Ô∏è DISCLAIMER: HINDI ITO GAMBLING SITE. For ENTERTAINMENT PURPOSES lamang.</div></div>

<div class="notes-container-bg">
    <div id="notesSection" class="notes-wrapper"></div>
</div>

<div class="container">
    <div class="video-feed-wrapper">
        <div class="video-container">
            <div class="video-overlay-bl"><i data-lucide="users" style="width:14px"></i><span id="onlineCount">0</span> ONLINE</div>
            <iframe width="100%" height="100%" src="https://www.youtube.com/embed/4I_NSJTbdXo?autoplay=1&mute=1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen style="border:none;"></iframe>
        </div>
    </div>

    <div id="jackpotBanner">
        <span>üéâ JACKPOT ROUND üéâ</span>
        <span class="jackpot-amount" id="jackpotDisplayVal">‚Ç±5,000</span>
    </div>

    <div id="nextDrawBanner" class="next-draw-container">
        <div class="nd-icon"><i data-lucide="calendar-days"></i></div>
        <div class="nd-info">
            <div class="next-draw-label">Susunod na Bola</div>
            <div id="nextDrawTime" class="next-draw-time">--:-- --</div>
        </div>
    </div>

    <div class="tab-system">
        <button class="tab-btn active" onclick="switchTab('bingo')"><i data-lucide="grid"></i> BINGO CARD</button>
        <button class="tab-btn bringme-tab" onclick="switchTab('bringme')"><i data-lucide="camera"></i> BRING ME</button>
        <button class="tab-btn minigame-tab" onclick="switchTab('minigames')"><i data-lucide="gamepad-2"></i> MINI GAMES</button>
    </div>

    <div id="winnerBanner">
        <span>üéâ BINGO WINNER! üéâ</span>
        <span class="winner-line" id="winnerPatternLine">Pattern: Normal Bingo</span>
    </div>

    <div id="bingoTab">
        <div class="draw-panel">
            <div class="prev-balls" id="ballRow"></div>
            <div class="current-ball-box"><span style="font-size:9px; font-weight:800; opacity:0.8; color:white;">NOW DRAWN</span><span id="currentBall" style="font-size:36px; font-weight:900; color:white; text-shadow:0 2px 10px rgba(0,0,0,0.5);">--</span></div>
        </div>
        <div class="card" id="bingoCardContainer">
            <div id="lateOverlay" class="late-overlay">
                <i data-lucide="lock" style="color:var(--danger); width:48px; height:48px; margin-bottom:15px;"></i>
                <div class="late-text">GAME ONGOING</div>
                <div class="late-subtext">Ongoing na ang bola. Next game ka na sumali.</div>
            </div>
            <div id="gameOverOverlay" class="game-over-overlay">
                <div class="late-text">Game Finished</div>
                <div class="late-subtext" id="gameOverMsg">Better luck next time!</div>
            </div>
            <div class="change-card-wrapper" style="display:flex; justify-content:space-between; align-items:center; padding-bottom:15px;">
                <div class="pattern-box" style="font-size:12px; font-weight:bold; color:var(--gold);">
                    PATTERN: <span id="patternName" style="color:white;">Normal Bingo</span>
                </div>
                <button class="btn-change" id="newCardBtn" onclick="generateNewCard()" style="background:none; border:1px solid rgba(255,255,255,0.5); color:white; padding:5px 10px; border-radius:8px;">NEW CARD</button>
            </div>
            <div class="bingo-header"><div class="letter">B</div><div class="letter">I</div><div class="letter">N</div><div class="letter">G</div><div class="letter">O</div></div>
            <div class="grid" id="bingoGrid"></div>
        </div>
    </div>

    <div id="bringmeTab" class="bringme-content">
        <div class="bringme-header-ai"><i data-lucide="cpu" style="width:14px"></i> AI VISION ACTIVE</div>
        <div class="bringme-status">
            <div id="bringmeInstruction" class="bringme-desc">Maghintay sa utos ng Host...</div>
            <div id="bringmeItem" class="bringme-target">SYSTEM READY</div>
            <div class="ai-camera-container">
                <div id="aiScanLine" class="ai-scanning-overlay"></div>
                <div id="aiPlaceholder" class="ai-placeholder">
                    <i data-lucide="aperture" style="width:48px; height:48px; color:var(--bringme); margin-bottom:10px;"></i>
                    <p style="font-size:11px; font-weight:700;">AI READY TO SCAN</p>
                </div>
                <img id="aiPreviewImg" src="">
            </div>
            <div id="uploadZone" style="display:none;">
                <input type="file" id="bringmeFile" accept="image/*" capture="environment" style="display:none;" onchange="handleBringMeUploadAdvanced(this)">
                <button class="btn-upload-advanced" onclick="document.getElementById('bringmeFile').click();">
                    <i data-lucide="camera"></i> CAPTURE & IDENTIFY
                </button>
            </div>
        </div>
    </div>

    <div id="minigamesTab" style="display:none;">
        <div class="minigame-lobby">
            <div class="game-poster" onclick="openGame('bonanza')" style="background-image: url('https://images.unsplash.com/photo-1579546929518-9e396f3cc809?q=80&w=2670&auto=format&fit=crop');">
                <div class="poster-play">NEW!</div>
                <div class="poster-content">
                    <div class="poster-title" style="color:#ffb6c1; text-shadow:0 2px 0 #db2777;">Candy Smash 1000</div>
                    <div class="poster-desc">Cluster pays & Tumbles. Win 1000x!</div>
                </div>
            </div>

            <div class="game-poster" onclick="openGame('slots')" style="background-image: url('https://images.unsplash.com/photo-1596838132731-3301c3fd4317?q=80&w=2070&auto=format&fit=crop');">
                <div class="poster-play">HOT</div>
                <div class="poster-content">
                    <div class="poster-title">Classic Slots</div>
                    <div class="poster-desc">Match 3 symbols to jackpot.</div>
                </div>
            </div>
            
            <div class="game-poster" onclick="openGame('roulette')" style="background-image: url('https://images.unsplash.com/photo-1606167668584-78701c57f13d?q=80&w=2070&auto=format&fit=crop');">
                <div class="poster-content">
                    <div class="poster-title">Roulette</div>
                    <div class="poster-desc">Spin the wheel. Win Big.</div>
                </div>
            </div>
            
             <div class="game-poster" onclick="openGame('highlow')" style="background-image: url('https://images.unsplash.com/photo-1549488497-657754d9297a?q=80&w=2070&auto=format&fit=crop');">
                <div class="poster-content">
                    <div class="poster-title">High Low</div>
                    <div class="poster-desc">Predict the next card.</div>
                </div>
            </div>
        </div>
    </div>

    <div class="chat-box card" style="padding:0; margin-top:15px;">
        <div class="chat-header">
            <i data-lucide="message-square" style="width:18px; color:var(--accent-glow)"></i>
            <h3>LIVE CHAT</h3>
        </div>
        <div id="chatList"></div>
        <div class="chat-input-area">
            <form class="input-wrapper" onsubmit="event.preventDefault(); sendChat();">
                <input type="text" id="chatIn" placeholder="Write a message..." autocomplete="off">
                <button type="submit" class="send-btn"><i data-lucide="send" style="width:18px"></i></button>
            </form>
        </div>
    </div>
</div>

<div id="game-bonanza" class="game-overlay-fs">
    <div class="go-header">
        <button class="go-back-btn" onclick="closeGame()"><i data-lucide="arrow-left"></i> LOBBY</button>
        <div class="go-title" style="color:white; font-family:'Arial Black', sans-serif; text-shadow:2px 2px 0 #db2777, -1px -1px 0 #db2777;">CANDY SMASH</div>
    </div>
    
    <div class="bonanza-container">
        <div class="bonanza-header-ui">
             <div class="b-feature-buy">
                 <span class="b-feature-text">BUY FREE SPINS</span>
                 <span class="b-feature-cost">‚Ç±2,500</span>
             </div>
             <div class="b-bet-panel">
                 <span class="b-feature-text" style="color:#064e3b">BET MULTIPLIER</span>
                 <span class="b-feature-cost" style="color:#064e3b">25x</span>
             </div>
        </div>

        <div class="bonanza-grid-frame">
            <div class="bonanza-grid" id="bonanzaGrid">
                </div>
            
            <div id="bonanzaResult" class="result-modal">
                <div class="res-title res-win" id="bResultTitle">BIG WIN!</div>
                <div class="res-pts" style="color:white; font-size:24px; font-weight:bold;" id="bResultPoints">+500</div>
                <button class="btn-play-again" onclick="resetGameUI('bonanza')">CONTINUE</button>
            </div>
        </div>

        <div class="b-controls">
            <div class="b-info-box">
                <div style="font-size:10px; opacity:0.8;">CREDIT</div>
                <div id="bCreditDisplay">‚Ç±0.00</div>
            </div>
            
            <div class="b-win-display" id="bWinDisplay"></div>
            
            <div class="b-spin-btn" id="bSpinBtn" onclick="playBonanza()">
                <i data-lucide="rotate-cw"></i>
            </div>
        </div>
    </div>
</div>

<div id="game-slots" class="game-overlay-fs">
    <div class="go-header">
        <button class="go-back-btn" onclick="closeGame()"><i data-lucide="arrow-left"></i> LOBBY</button>
        <div class="go-title" style="color:#fbbf24;">Classic Slots</div>
    </div>
    <div style="flex:1; display:flex; align-items:center; justify-content:center; flex-direction:column;">
        <div class="slot-machine-frame">
            <div class="slot-window">
                <div class="reel-col" id="reel1"><span>üçí</span></div>
                <div class="reel-col" id="reel2"><span>üçã</span></div>
                <div class="reel-col" id="reel3"><span>üîî</span></div>
                
                 <div id="slotResult" class="result-modal">
                    <div class="res-title res-win" id="slotTitle">JACKPOT!</div>
                    <div style="color:white; margin-bottom:10px;">+100 Points</div>
                    <button class="btn-play-again" onclick="resetGameUI('slot')">SPIN AGAIN</button>
                </div>
            </div>
            <button class="slot-lever-btn" id="btnPullLever" onclick="pullSlotLever()">SPIN</button>
        </div>
    </div>
</div>

<div id="game-roulette" class="game-overlay-fs">
    <div class="go-header">
        <button class="go-back-btn" onclick="closeGame()"><i data-lucide="arrow-left"></i> LOBBY</button>
        <div class="go-title" style="color:#ef4444;">Roulette</div>
    </div>
    <div style="flex:1; display:flex; align-items:center; justify-content:center; flex-direction:column;">
        <div class="roulette-table">
            <div class="wheel-outer">
                <div class="wheel-inner" id="wheelInner"></div>
                <div class="roulette-ball" id="rouletteBall"></div>
            </div>
            <div id="rouletteResult" class="result-modal">
                <div class="res-title res-win" id="rouletteTitle">YOU WON!</div>
                <button class="btn-play-again" onclick="resetGameUI('roulette')">PLAY AGAIN</button>
            </div>
            <button id="btnSpinWheel" onclick="spinRoulette()" class="slot-lever-btn" style="margin-top:30px; background: linear-gradient(180deg, #10b981, #047857);">SPIN WHEEL</button>
        </div>
    </div>
</div>

<div id="game-highlow" class="game-overlay-fs">
    <div class="go-header">
        <button class="go-back-btn" onclick="closeGame()"><i data-lucide="arrow-left"></i> LOBBY</button>
        <div class="go-title" style="color:#3b82f6;">High Low</div>
    </div>
    <div style="flex:1; display:flex; align-items:center; justify-content:center; flex-direction:column;">
        <div class="hl-table" style="width:100%; max-width:380px;">
            <div class="playing-card" id="mainCard">
               <span id="cardValDisplay">7</span>
               <div id="hlResult" class="result-modal" style="border-radius:18px;">
                    <div class="res-title res-win" id="hlTitle">CORRECT</div>
                    <button class="btn-play-again" onclick="resetGameUI('hl')">PLAY AGAIN</button>
                </div>
            </div>
            <div style="display: flex; gap: 15px; justify-content: center;">
                <button class="btn-guess bg-hi" id="btnHi" onclick="guessHighLow('high')">HIGHER ‚ñ≤</button>
                <button class="btn-guess bg-lo" id="btnLo" onclick="guessHighLow('low')">LOWER ‚ñº</button>
            </div>
        </div>
    </div>
</div>

<div id="storeModal" class="modal" onclick="this.style.display='none'"><div class="modal-content"><h3 style="color:white;">Rewards</h3><p style="color:gray;">Coming Soon</p></div></div>
<div id="menuModal" class="modal" onclick="this.style.display='none'"><div class="modal-content"><h3 style="color:white;">Profile</h3><button onclick="auth.signOut().then(()=>location.reload())" style="width:100%; padding:10px; background:red; border:none; color:white; border-radius:10px;">Sign Out</button></div></div>

<script>
    lucide.createIcons();
    // FIREBASE INIT
    const firebaseConfig = { apiKey: "AIzaSyDIAQXJ15atKJxu7PtcFL1W9JnO1N14pVs", authDomain: "radiobingo-9ac29.firebaseapp.com", databaseURL: "https://radiobingo-9ac29-default-rtdb.asia-southeast1.firebasedatabase.app", projectId: "radiobingo-9ac29", storageBucket: "radiobingo-9ac29.firebasestorage.app", messagingSenderId: "965903993397", appId: "1:965903993397:web:f6646fa05225f147eebf7c" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database(); const auth = firebase.auth();
    let userData = {}; let cardNumbers = []; let marks = [12]; let gameDrawn = [];

    // SOUNDS
    const sounds = {
        click: new Audio('https://cdn.pixabay.com/audio/2022/03/15/audio_2731885542.mp3'),
        pop: new Audio('https://cdn.freesound.org/previews/536/536108_1415754-lq.mp3'),
        win: new Audio('https://cdn.freesound.org/previews/270/270404_5123851-lq.mp3'),
        lose: new Audio('https://cdn.freesound.org/previews/76/76376_877451-lq.mp3'),
        spin: new Audio('https://cdn.freesound.org/previews/413/413203_5121236-lq.mp3'),
        tumble: new Audio('https://cdn.freesound.org/previews/256/256113_3263906-lq.mp3') // Used for Bonanza pop
    };
    function playSound(t) { if(sounds[t]) { sounds[t].currentTime=0; sounds[t].play().catch(()=>{}); } }

    // LOGIN & USER
    function login() { playSound('click'); auth.signInWithPopup(new firebase.auth.GoogleAuthProvider()); }
    auth.onAuthStateChanged(u => {
        if(u) {
            document.getElementById('loginOverlay').style.display = 'none'; document.getElementById('userPanel').style.display = 'flex';
            document.getElementById('userImg').src = u.photoURL;
            db.ref('users/'+u.uid).on('value', s => { 
                if(s.exists()){ userData = s.val(); userData.uid = u.uid; document.getElementById('userPoints').innerText = (userData.points || 0).toLocaleString(); document.getElementById('bCreditDisplay').innerText = "‚Ç±" + (userData.points || 0).toLocaleString(); }
                else { db.ref('users/'+u.uid).set({ name: u.displayName, photo: u.photoURL, points: 100 }); }
            });
            initBingo(); setupChat();
        } else { document.getElementById('loginOverlay').style.display = 'flex'; }
    });

    // NAVIGATION
    function switchTab(tab) {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('bingoTab').style.display = 'none'; 
        document.getElementById('bringmeTab').style.display = 'none';
        document.getElementById('minigamesTab').style.display = 'none';
        
        if(tab === 'bingo') { document.getElementById('bingoTab').style.display = 'block'; document.querySelectorAll('.tab-btn')[0].classList.add('active'); } 
        else if(tab === 'bringme') { document.getElementById('bringmeTab').style.display = 'block'; document.querySelectorAll('.tab-btn')[1].classList.add('active'); } 
        else if(tab === 'minigames') { document.getElementById('minigamesTab').style.display = 'block'; document.querySelectorAll('.tab-btn')[2].classList.add('active'); }
        playSound('click');
    }

    // GAME OVERLAYS
    function openGame(g) { 
        playSound('click'); 
        document.querySelector('.nav').style.display='none'; 
        document.querySelector('.tab-system').style.display='none';
        document.getElementById('minigamesTab').style.display='none'; 
        
        if(g==='bonanza') { initBonanza(); document.getElementById('game-bonanza').style.display='flex'; }
        if(g==='slots') document.getElementById('game-slots').style.display='flex';
        if(g==='roulette') document.getElementById('game-roulette').style.display='flex';
        if(g==='highlow') document.getElementById('game-highlow').style.display='flex';
    }
    function closeGame() {
        playSound('click'); 
        document.querySelectorAll('.game-overlay-fs').forEach(e=>e.style.display='none');
        document.querySelector('.nav').style.display='flex'; 
        document.querySelector('.tab-system').style.display='flex';
        document.getElementById('minigamesTab').style.display='block'; 
        resetGameUI();
    }
    function addPoints(pts) { db.ref('users/' + auth.currentUser.uid + '/points').transaction(p => (p || 0) + pts); }

    // ============================================
    // NEW GAME: CANDY SMASH 1000 (Sweet Bonanza Logic)
    // ============================================
    
    const bSymbols = ['üçé','üçå','üçá','üçâ','ü´ê','üü¶','üü©','üü™','‚ù§Ô∏è'];
    // 6x5 Grid
    let bGrid = [];
    let bIsSpinning = false;
    
    function initBonanza() {
        const gridEl = document.getElementById('bonanzaGrid');
        gridEl.innerHTML = '';
        bGrid = [];
        // Create initial static grid
        for(let r=0; r<5; r++) {
            let row = [];
            for(let c=0; c<6; c++) {
                const sym = bSymbols[Math.floor(Math.random() * bSymbols.length)];
                row.push(sym);
                const cell = document.createElement('div');
                cell.className = 'b-cell';
                cell.id = `cell-${r}-${c}`;
                cell.innerHTML = `<div class="b-symbol">${sym}</div>`;
                gridEl.appendChild(cell);
            }
            bGrid.push(row);
        }
    }

    async function playBonanza() {
        if(bIsSpinning) return;
        if((userData.points || 0) < 50) return alert("Not enough points! (Cost: 50)");
        
        // Deduct Cost
        addPoints(-50);
        
        bIsSpinning = true;
        const btn = document.getElementById('bSpinBtn');
        btn.classList.add('disabled');
        document.getElementById('bWinDisplay').innerText = '';
        document.getElementById('bonanzaResult').style.display = 'none';

        playSound('spin');

        // 1. Animate Spin (Refill Grid)
        await performSpinAnimation();

        // 2. Check Wins & Tumble Loop
        let totalRoundWin = 0;
        let keepTumbling = true;
        let tumbleCount = 0;

        while(keepTumbling && tumbleCount < 5) { // Safety cap of 5 tumbles
            const wins = checkClusterWins(); // Logic: Find 8+ same symbols
            
            if(wins.length > 0) {
                // Calculate Points
                let stepWin = 0;
                wins.forEach(w => {
                    // Simple logic: 8 symbols = 10pts, every extra symbol +5pts
                    let pts = 10 + ((w.count - 8) * 5);
                    if(w.char === '‚ù§Ô∏è') pts *= 5; // High value
                    if(w.char === 'üü™') pts *= 3;
                    stepWin += pts;
                });
                totalRoundWin += stepWin;

                // Visual: Highlight & Pop
                await highlightAndPop(wins, stepWin);
                
                // Logic: Remove & Drop
                updateGridData(wins);
                await renderDrop();
                
                playSound('pop');
                tumbleCount++;
            } else {
                keepTumbling = false;
            }
        }

        // 3. End Game
        if(totalRoundWin > 0) {
            playSound('win');
            document.getElementById('bResultTitle').innerText = totalRoundWin > 100 ? "SENSATIONAL!" : "BIG WIN!";
            document.getElementById('bResultPoints').innerText = "+" + totalRoundWin;
            document.getElementById('bonanzaResult').style.display = 'flex';
            addPoints(totalRoundWin);
            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
        } else {
             btn.classList.remove('disabled');
        }
        bIsSpinning = false;
    }

    function performSpinAnimation() {
        return new Promise(resolve => {
            const cells = document.querySelectorAll('.b-cell');
            cells.forEach(c => c.innerHTML = ''); // Clear
            
            // Fill new data
            bGrid = [];
            for(let r=0; r<5; r++) {
                let row = [];
                for(let c=0; c<6; c++) {
                    row.push(bSymbols[Math.floor(Math.random() * bSymbols.length)]);
                }
                bGrid.push(row);
            }

            // Drop effect delay
            let i = 0;
            const interval = setInterval(() => {
                if(i >= 30) {
                    clearInterval(interval);
                    resolve();
                    return;
                }
                const r = Math.floor(i / 6);
                const c = i % 6;
                const cell = document.getElementById(`cell-${r}-${c}`);
                const sym = bGrid[r][c];
                cell.innerHTML = `<div class="b-symbol" style="animation: fallDown 0.3s ease forwards">${sym}</div>`;
                i++;
            }, 30);
        });
    }

    function checkClusterWins() {
        // Count frequencies
        let counts = {};
        let winSymbols = [];
        
        // Flatten check
        for(let r=0; r<5; r++) {
            for(let c=0; c<6; c++) {
                const char = bGrid[r][c];
                if(!counts[char]) counts[char] = [];
                counts[char].push({r,c});
            }
        }

        // Filter those with >= 8
        Object.keys(counts).forEach(k => {
            if(counts[k].length >= 8) {
                winSymbols.push({ char: k, indices: counts[k], count: counts[k].length });
            }
        });

        return winSymbols;
    }

    function highlightAndPop(wins, amount) {
        return new Promise(resolve => {
            // Show Amount text in center
            document.getElementById('bWinDisplay').innerText = "‚Ç±" + amount;

            // Highlight cells
            wins.forEach(w => {
                w.indices.forEach(pos => {
                    const el = document.getElementById(`cell-${pos.r}-${pos.c}`);
                    el.classList.add('b-win');
                    // Add pop text
                    const pt = document.createElement('div');
                    pt.className = 'b-pop-text';
                    pt.innerText = (amount / w.count).toFixed(0);
                    el.appendChild(pt);
                });
            });
            playSound('tumble');
            
            setTimeout(() => {
                resolve();
            }, 1200); // Wait for animation
        });
    }

    function updateGridData(wins) {
        // Remove winners from grid array (set to null)
        wins.forEach(w => {
            w.indices.forEach(pos => {
                bGrid[pos.r][pos.c] = null;
            });
        });

        // Gravity Logic
        for(let c=0; c<6; c++) {
            let newCol = [];
            // Collect non-nulls
            for(let r=0; r<5; r++) {
                if(bGrid[r][c] !== null) newCol.push(bGrid[r][c]);
            }
            // Fill top with random
            while(newCol.length < 5) {
                newCol.unshift(bSymbols[Math.floor(Math.random() * bSymbols.length)]); // Add to top
            }
            // Write back to grid
            for(let r=0; r<5; r++) {
                bGrid[r][c] = newCol[r];
            }
        }
    }

    function renderDrop() {
        return new Promise(resolve => {
            // Re-render whole grid quickly
            for(let r=0; r<5; r++) {
                for(let c=0; c<6; c++) {
                    const cell = document.getElementById(`cell-${r}-${c}`);
                    cell.className = 'b-cell'; // Reset classes
                    cell.innerHTML = `<div class="b-symbol" style="animation: bounceIn 0.3s">${bGrid[r][c]}</div>`;
                }
            }
            setTimeout(resolve, 400);
        });
    }


    // ============================================
    // OTHER MINI GAMES LOGIC
    // ============================================

    function resetGameUI(t) {
        document.querySelectorAll('.result-modal').forEach(e => e.style.display='none');
        document.querySelectorAll('button').forEach(b => b.classList.remove('disabled'));
        if(t==='bonanza') document.getElementById('bSpinBtn').classList.remove('disabled');
        if(t==='slot') document.getElementById('btnPullLever').disabled = false;
    }

    // SLOTS
    function pullSlotLever() {
        const btn = document.getElementById('btnPullLever');
        btn.disabled = true; playSound('spin');
        const r1 = document.getElementById('reel1'), r2 = document.getElementById('reel2'), r3 = document.getElementById('reel3');
        const syms = ["üçí", "üçã", "üîî", "üíé", "7Ô∏è‚É£"];
        
        // Anim
        [r1,r2,r3].forEach(r => r.querySelector('span').innerHTML = '<div style="filter:blur(5px)">üé∞</div>');

        setTimeout(() => {
            const s1 = syms[Math.floor(Math.random()*syms.length)];
            const s2 = syms[Math.floor(Math.random()*syms.length)];
            const s3 = syms[Math.floor(Math.random()*syms.length)];
            
            r1.querySelector('span').innerText = s1;
            setTimeout(() => r2.querySelector('span').innerText = s2, 200);
            setTimeout(() => {
                r3.querySelector('span').innerText = s3;
                if(s1===s2 && s2===s3) {
                    playSound('win');
                    document.getElementById('slotResult').style.display = 'flex';
                    addPoints(100);
                    confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
                } else {
                    playSound('lose');
                    btn.disabled = false;
                }
            }, 400);
        }, 1000);
    }

    // ROULETTE
    function spinRoulette() {
        playSound('spin');
        const inner = document.getElementById('wheelInner');
        inner.style.transform = `rotate(${1080 + Math.floor(Math.random()*360)}deg)`;
        setTimeout(() => {
            const win = Math.random() < 0.48;
            if(win) { playSound('win'); document.getElementById('rouletteResult').style.display='flex'; document.getElementById('rouletteTitle').className='res-title res-win'; document.getElementById('rouletteTitle').innerText='YOU WON!'; addPoints(50); }
            else { playSound('lose'); document.getElementById('rouletteResult').style.display='flex'; document.getElementById('rouletteTitle').className='res-title res-loss'; document.getElementById('rouletteTitle').innerText='TRY AGAIN'; }
        }, 3000);
    }

    // HIGH LOW
    function guessHighLow(c) {
        playSound('click');
        const val = parseInt(document.getElementById('cardValDisplay').innerText);
        const next = Math.floor(Math.random()*13)+1; // 1-13
        document.getElementById('cardValDisplay').innerText = next;
        
        const win = (c==='high' && next > val) || (c==='low' && next < val);
        const res = document.getElementById('hlResult');
        const title = document.getElementById('hlTitle');
        
        res.style.display = 'flex';
        if(win) { title.innerText="CORRECT"; title.className="res-title res-win"; playSound('win'); addPoints(20); }
        else { title.innerText="WRONG"; title.className="res-title res-loss"; playSound('lose'); }
    }

    // BINGO LOGIC (UNCHANGED)
    function initBingo() {
        db.ref('gameState/currentPattern').on('value', s => document.getElementById('patternName').innerText = s.val() || "Normal Bingo");
        db.ref('drawnNumbers').on('value', s => {
            const val = s.val(); const newDrawn = val ? Object.values(val).map(n => n.toString()) : [];
            gameDrawn = newDrawn; document.getElementById('currentBall').innerText = gameDrawn.length ? gameDrawn[gameDrawn.length-1] : "--";
            
            // Render Prev Balls
            const ballRow = document.getElementById('ballRow'); ballRow.innerHTML = "";
            [...gameDrawn].reverse().slice(1,10).forEach(n => { const b = document.createElement('div'); b.className = 'ball-small'; b.innerText = n; ballRow.appendChild(b); });

            updateGridHits();
        });
    }

    function generateNewCard() {
        if(gameDrawn.length > 0) return alert("Game ongoing!");
        const getCol = (min, max) => { let nums = []; while(nums.length < 5) { let r = Math.floor(Math.random() * (max - min + 1)) + min; if(!nums.includes(r)) nums.push(r); } return nums.sort((a,b) => a-b); };
        const b = getCol(1, 15), i = getCol(16, 30), n = getCol(31, 45), g = getCol(46, 60), o = getCol(61, 75);
        n[2] = "FREE"; cardNumbers = [];
        for(let row=0; row<5; row++) cardNumbers.push(b[row], i[row], n[row], g[row], o[row]);
        renderCard();
    }

    function renderCard() {
        const grid = document.getElementById('bingoGrid'); grid.innerHTML = "";
        cardNumbers.forEach((n, idx) => { let d = document.createElement('div'); d.className = 'cell' + (idx===12?' hit':''); d.id = 'c-'+idx; d.innerText = n==="FREE"?"‚òÖ":n; grid.appendChild(d); });
    }

    function updateGridHits() {
        cardNumbers.forEach((n, idx) => {
            const el = document.getElementById('c-'+idx); 
            if(idx === 12) { if(el) el.classList.add('hit'); return; }
            if(gameDrawn.includes(n.toString())) { if(el) el.classList.add('hit'); }
        });
    }
    
    // CHAT & OTHERS
    function setupChat() { db.ref('chats').limitToLast(25).on('child_added', s => { 
        const c = s.val(); const list = document.getElementById('chatList');
        const row = document.createElement('div'); row.className = 'chat-row';
        row.innerHTML = `<img src="${c.pfp}" class="chat-pfp"><div class="chat-content"><div class="bubble"><span class="chat-name">${c.name}</span><span class="chat-text">${c.msg}</span></div></div>`;
        list.appendChild(row); list.scrollTop = list.scrollHeight;
    }); }
    function sendChat() { const inp = document.getElementById('chatIn'); if(inp.value.trim()) db.ref('chats').push({ uid: auth.currentUser.uid, name: auth.currentUser.displayName, pfp: auth.currentUser.photoURL, msg: inp.value.trim() }); inp.value=""; }

    // COCO SSD LOAD
    cocoSsd.load().then(() => console.log("AI Loaded"));
    async function handleBringMeUploadAdvanced(input) { alert("AI Scanning is active (Simulated for Demo)"); }

</script>
</body>
</html>
