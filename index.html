<!DOCTYPE html>
<html lang="tl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0f172a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Radio Bingo Live | Social Ecosystem</title>
    
    <script>
        if (window.location.pathname.endsWith("index.html")) {
            var newPath = window.location.pathname.replace(/index\.html$/, "");
            window.history.replaceState({}, document.title, newPath);
        }
    </script>

    <link rel="icon" type="image/png" href="https://i.imgur.com/7D8u8h6.png">
    <link rel="apple-touch-icon" href="https://i.imgur.com/7D8u8h6.png">
    <link rel="manifest" href="manifest.json">
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&family=Comic+Neue:wght@700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-messaging.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <script src="https://pl28660488.effectivegatecpm.com/9b/f5/85/9bf585b6ee39cb9b515e2fae1fa958c2.js"></script>
    <script src="https://pl28660496.effectivegatecpm.com/a6/64/bf/a664bf7e7084386b4f4b428590030df3.js"></script>

    <style>
        /* === CORE VARIABLES === */
        :root { 
            --bg-overlay: rgba(15, 23, 42, 0.95); 
            --glass-surface: rgba(30, 41, 59, 0.75);
            --glass-border: rgba(255, 255, 255, 0.1);
            
            --accent: #0ea5e9; /* Ocean Blue */
            --accent-glow: #38bdf8;
            --text: #ffffff; 
            --gold: #fbbf24; 
            --gold-shine: #fcd34d;
            --success: #10b981; 
            --danger: #ef4444; 
            --minigame: #f472b6;
            
            /* Messenger Colors */
            --messenger-blue: #0084ff;
            --messenger-grey: #303030;
            --messenger-bg: #000000;
        }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        
        body { 
            font-family: 'Inter', sans-serif; 
            background: #0f172a;
            color: var(--text); 
            margin: 0; 
            padding-bottom: 90px; /* Increased for Ad + Nav */
            overflow-x: hidden; 
            min-height: 100vh;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        /* === CUSTOM POP-UP BANNER STYLES === */
        #customPopupBanner { display: none; position: fixed; inset: 0; z-index: 9999999; background: rgba(0,0,0,0.85); align-items: center; justify-content: center; flex-direction: column; padding: 20px; backdrop-filter: blur(5px); }
        
        /* === CARD SKINS & HIT FIXES === */
        /* IMPORTANT: The .hit class must override skin backgrounds to show "Tantos" */
        
        .card-skin-neon { border: 2px solid #06b6d4 !important; box-shadow: 0 0 20px #06b6d4, inset 0 0 20px rgba(6, 182, 212, 0.2) !important; background: rgba(8, 51, 68, 0.9) !important; }
        .card-skin-neon .cell { border-color: #06b6d4 !important; color: #67e8f9 !important; text-shadow: 0 0 5px #06b6d4 !important; }
        
        .card-skin-gold { border: 2px solid #f59e0b !important; box-shadow: 0 0 25px #f59e0b, inset 0 0 10px #f59e0b !important; background: linear-gradient(135deg, #451a03, #000) !important; }
        .card-skin-gold .cell { border-color: #fbbf24 !important; color: #fcd34d !important; font-family: 'Times New Roman', serif; }
        
        .card-skin-pink { border: 2px solid #ec4899 !important; box-shadow: 0 0 20px #ec4899 !important; background: rgba(80, 7, 36, 0.9) !important; }
        .card-skin-pink .cell { border-color: #f472b6 !important; color: #fbcfe8 !important; border-radius: 50% !important; }
        
        .card-skin-matrix { border: 2px solid #22c55e !important; box-shadow: 0 0 15px #22c55e !important; background: black !important; font-family: 'Courier New', monospace; }
        .card-skin-matrix .cell { border-color: #22c55e !important; color: #4ade80 !important; border-radius: 0 !important; }

        /* CHARACTER THEMES */
        .card-skin-kitty { border: 4px solid #ffc0cb !important; background: radial-gradient(circle, #fff0f5, #ff69b4) !important; box-shadow: 0 0 20px #ff69b4 !important; font-family: 'Comic Neue', cursive; }
        .card-skin-kitty .cell { background: white !important; color: #ff1493 !important; border: 2px solid #ffc0cb !important; border-radius: 15px !important; }
        .card-skin-kitty .bingo-header .letter { color: #ff1493 !important; text-shadow: 2px 2px 0px white !important; }

        .card-skin-doraemon { border: 4px solid #0096df !important; background: linear-gradient(180deg, #0096df 0%, #ffffff 100%) !important; box-shadow: 0 0 20px #dd1616 !important; }
        .card-skin-doraemon .cell { background: rgba(255,255,255,0.9) !important; color: #0096df !important; border: 2px solid #dd1616 !important; border-radius: 50% !important; }
        .card-skin-doraemon .bingo-header .letter { color: #dd1616 !important; text-shadow: 2px 2px 0px white !important; }

        .card-skin-spongebob { border: 4px solid #f7f44d !important; background: url('https://upload.wikimedia.org/wikipedia/commons/thumb/e/e6/SpongeBob_SquarePants_logo.svg/1200px-SpongeBob_SquarePants_logo.svg.png'), #f7f44d !important; background-size: cover !important; box-shadow: 0 0 20px #f7f44d !important; }
        .card-skin-spongebob .cell { background: rgba(255,255,255,0.8) !important; color: #7d5837 !important; border: 2px dashed #7d5837 !important; }
        
        .card-skin-kuromi { border: 4px solid #000000 !important; background: linear-gradient(135deg, #000000, #4b0082) !important; box-shadow: 0 0 20px #ea65a2 !important; }
        .card-skin-kuromi .cell { background: rgba(234, 101, 162, 0.2) !important; color: #ea65a2 !important; border: 1px solid #ea65a2 !important; border-radius: 8px 0 8px 0 !important; }

        /* CUSTOM BACKGROUND SKIN */
        .card-skin-custom { background-size: cover !important; background-position: center !important; border: 2px solid rgba(255,255,255,0.5) !important; box-shadow: 0 0 30px rgba(0,0,0,0.8) !important; }
        .card-skin-custom .cell { background: rgba(0,0,0,0.6) !important; backdrop-filter: blur(4px); color: white !important; border: 1px solid rgba(255,255,255,0.3) !important; }

        /* UNIVERSAL HIT STATE - Fix for Tantos */
        .cell.hit { 
            background: linear-gradient(135deg, var(--accent), #2563eb) !important; 
            color: white !important; 
            transform: scale(1.05); 
            border-color: rgba(255,255,255,0.6) !important; 
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.6) !important; 
            text-shadow: 0 2px 2px rgba(0,0,0,0.5) !important;
            opacity: 1 !important;
            z-index: 10;
        }

        .store-nav { display: flex; gap: 8px; margin-bottom: 15px; background: rgba(0,0,0,0.3); padding: 5px; border-radius: 12px; }
        .store-tab-btn { flex: 1; padding: 10px; border: none; background: transparent; color: #94a3b8; font-weight: 800; border-radius: 8px; cursor: pointer; font-size: 11px; text-transform: uppercase; }
        .store-tab-btn.active { background: var(--accent); color: white; box-shadow: 0 4px 10px rgba(14, 165, 233, 0.3); }
        .skins-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .skin-item { background: rgba(255,255,255,0.05); padding: 10px; border-radius: 16px; border: 1px solid rgba(255,255,255,0.1); text-align: center; position: relative; overflow: hidden; }
        .skin-preview { height: 60px; border-radius: 8px; margin-bottom: 8px; display: flex; align-items: center; justify-content: center; font-size: 20px; font-weight: 900; background-size: cover; background-position: center; }
        .skin-name { font-size: 12px; font-weight: 800; color: white; margin-bottom: 4px; }
        .skin-cost { font-size: 10px; color: var(--gold); margin-bottom: 8px; font-weight: 700; }
        .btn-buy-skin { width: 100%; padding: 8px; border: none; border-radius: 8px; font-weight: 800; font-size: 10px; cursor: pointer; }
        .btn-buy-skin.owned { background: rgba(255,255,255,0.1); color: #cbd5e1; cursor: default; }
        .btn-buy-skin.buy { background: var(--gold); color: black; }
        .btn-buy-skin.equip { background: var(--success); color: white; }
        .task-list { display: flex; flex-direction: column; gap: 10px; }
        .task-item { background: linear-gradient(135deg, rgba(30,41,59,0.9), rgba(15,23,42,0.95)); padding: 15px; border-radius: 16px; border: 1px solid rgba(255,255,255,0.1); display: flex; justify-content: space-between; align-items: center; position: relative; overflow: hidden; }
        .task-info h4 { margin: 0; font-size: 13px; font-weight: 900; color: white; letter-spacing: 0.5px; }
        .task-info p { margin: 3px 0 0; font-size: 10px; color: #94a3b8; }
        .task-reward { background: rgba(251, 191, 36, 0.15); color: var(--gold); padding: 4px 8px; border-radius: 6px; font-size: 10px; font-weight: 800; margin-top: 5px; display: inline-block; border: 1px solid rgba(251, 191, 36, 0.3); }
        .btn-do-task { background: var(--accent); color: white; border: none; padding: 10px 18px; border-radius: 10px; font-weight: 800; font-size: 11px; cursor: pointer; transition: 0.2s; box-shadow: 0 4px 10px rgba(14, 165, 233, 0.3); min-width: 80px; z-index: 2; }
        .btn-do-task:hover { transform: translateY(-2px); }
        .btn-do-task:disabled { background: #334155; color: #94a3b8; cursor: not-allowed; transform: none; box-shadow: none; }
        .flying-coin { position: fixed; width: 24px; height: 24px; background-image: url('https://cdn-icons-png.flaticon.com/512/217/217853.png'); background-size: contain; background-repeat: no-repeat; z-index: 99999; pointer-events: none; will-change: transform, opacity; }
        @keyframes shake-hard { 0% { transform: translate(0, 0); } 25% { transform: translate(-3px, 3px); } 50% { transform: translate(3px, -3px); } 75% { transform: translate(-3px, -3px); } 100% { transform: translate(0, 0); } }
        .shake-effect { animation: shake-hard 0.3s ease-in-out; will-change: transform; }
        .float-loss { position: fixed; color: #ef4444; font-weight: 900; font-size: 18px; z-index: 100000; pointer-events: none; animation: floatDownFade 1s ease-out forwards; text-shadow: 0 1px 2px black; }
        @keyframes floatDownFade { 0% { transform: translateY(0) scale(1); opacity: 1; } 100% { transform: translateY(40px) scale(0.8); opacity: 0; } }
        #installGate { position: fixed; inset: 0; z-index: 2147483647; background: #0f172a; background-image: radial-gradient(circle at top right, rgba(14, 165, 233, 0.2), transparent 40%), radial-gradient(circle at bottom left, rgba(251, 191, 36, 0.1), transparent 40%); display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 30px; }
        .gate-logo { font-size: 64px; font-weight: 900; letter-spacing: -3px; color: white; margin-bottom: 10px; text-shadow: 0 0 40px rgba(14, 165, 233, 0.6); animation: floatLogo 3s ease-in-out infinite; }
        .gate-logo span { color: var(--accent-glow); }
        @keyframes floatLogo { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        .gate-title { font-size: 24px; font-weight: 800; color: white; margin-bottom: 15px; line-height: 1.3; }
        .gate-desc { font-size: 14px; color: #cbd5e1; max-width: 320px; margin-bottom: 40px; line-height: 1.6; opacity: 0.8; }
        .gate-btn-install { background: linear-gradient(135deg, var(--accent), #2563eb); color: white; border: none; padding: 18px 40px; border-radius: 50px; font-weight: 900; font-size: 16px; cursor: pointer; box-shadow: 0 0 30px rgba(14, 165, 233, 0.5); transition: transform 0.2s; display: flex; align-items: center; gap: 10px; border: 2px solid rgba(255,255,255,0.2); animation: pulseBtn 2s infinite; }
        .gate-btn-install:active { transform: scale(0.95); }
        @keyframes pulseBtn { 0% { box-shadow: 0 0 0 0 rgba(14, 165, 233, 0.7); } 70% { box-shadow: 0 0 0 20px rgba(14, 165, 233, 0); } 100% { box-shadow: 0 0 0 0 rgba(14, 165, 233, 0); } }
        .gate-ios-note { margin-top: 30px; background: rgba(255,255,255,0.05); padding: 20px; border-radius: 16px; border: 1px solid rgba(255,255,255,0.1); max-width: 320px; text-align: left; display: none; }
        .ios-step { display: flex; gap: 10px; margin-bottom: 10px; align-items: center; font-size: 13px; color: #e2e8f0; }
        .ios-icon { color: var(--accent-glow); }
        #notifBlocker { position: fixed; inset: 0; z-index: 9999999; background: rgba(15, 23, 42, 0.98); display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 30px; backdrop-filter: blur(10px); }
        .notif-gate-icon { width: 80px; height: 80px; background: rgba(59, 130, 246, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; box-shadow: 0 0 30px rgba(59, 130, 246, 0.4); animation: pulseGate 2s infinite; }
        @keyframes pulseGate { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        .notif-gate-title { font-size: 24px; font-weight: 900; margin-bottom: 10px; color: white; }
        .notif-gate-desc { font-size: 14px; color: #cbd5e1; margin-bottom: 30px; line-height: 1.6; max-width: 300px; }
        .btn-allow-notif { background: linear-gradient(135deg, var(--accent), #2563eb); color: white; border: none; padding: 15px 30px; border-radius: 16px; font-weight: 800; font-size: 16px; cursor: pointer; box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4); transition: 0.3s; width: 100%; max-width: 250px; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .btn-allow-notif:hover { transform: translateY(-3px); }
        .blocked-help { display: none; background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); padding: 15px; border-radius: 12px; margin-top: 20px; font-size: 12px; text-align: left; }
        #splash-screen { position: fixed; inset: 0; background: #0f172a; z-index: 99999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.8s ease, visibility 0.8s; }
        .splash-logo { font-size: 60px; font-weight: 900; letter-spacing: -3px; color: white; animation: pulseLogo 2s infinite ease-in-out; text-shadow: 0 0 30px rgba(14, 165, 233, 0.5); }
        .splash-logo span { color: var(--accent-glow); }
        .splash-loader { width: 40px; height: 40px; border: 4px solid rgba(255,255,255,0.1); border-top: 4px solid var(--accent); border-radius: 50%; margin-top: 20px; animation: spin 1s linear infinite; }
        @keyframes pulseLogo { 0%, 100% { transform: scale(1); filter: drop-shadow(0 0 10px rgba(56,189,248,0.2)); } 50% { transform: scale(1.1); filter: drop-shadow(0 0 30px rgba(56,189,248,0.8)); } }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        #customToast { position: fixed; top: 20px; left: 50%; transform: translateX(-50%) translateY(-150%); background: rgba(15, 23, 42, 0.95); border: 1px solid var(--accent); padding: 16px 24px; border-radius: 16px; z-index: 100000; display: flex; align-items: center; justify-content: center; text-align: center; gap: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.8); backdrop-filter: blur(12px); transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); min-width: 280px; max-width: 90%; }
        #customToast.show { transform: translateX(-50%) translateY(0); }
        .toast-icon { color: var(--gold); flex-shrink: 0; }
        .toast-msg { font-size: 14px; font-weight: 700; color: white; line-height: 1.4; }
        .glass-panel { background: var(--glass-surface); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); border: 1px solid var(--glass-border); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5); }
        
        .ad-container-global { position: relative; z-index: 10 !important; width: 320px; height: 50px; display: flex; justify-content: center; align-items: center; margin: 10px auto; background: rgba(0,0,0,0.4); border-radius: 4px; border: 1px dashed rgba(255,255,255,0.3); text-align: center; overflow: hidden; clear: both; }
        
        .sticky-ad-footer { position: fixed; bottom: 65px; left: 0; right: 0; height: 50px; background: #000; z-index: 4999; display: flex; justify-content: center; align-items: center; border-top: 1px solid #333; }

        #jackpotBanner { background: linear-gradient(135deg, #271a00 0%, #451a03 50%, #000000 100%); border: 2px solid #fbbf24; color: #fbbf24; padding: 15px; text-align: center; border-radius: 18px; box-shadow: 0 0 25px rgba(251, 191, 36, 0.3), inset 0 0 20px rgba(251, 191, 36, 0.1); display: none; margin-bottom: 15px; position: relative; overflow: hidden; animation: pulse-border 2s infinite; }
        #jackpotBanner::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: linear-gradient(45deg, transparent, rgba(251, 191, 36, 0.2), transparent); animation: shimmer 3s infinite linear; }
        @keyframes shimmer { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }
        @keyframes pulse-border { 0% { box-shadow: 0 0 15px rgba(251, 191, 36, 0.2); border-color: #b45309; } 50% { box-shadow: 0 0 35px rgba(251, 191, 36, 0.6); border-color: #fbbf24; } 100% { box-shadow: 0 0 15px rgba(251, 191, 36, 0.2); border-color: #b45309; } }
        .jp-label-new { font-size: 11px; font-weight: 900; letter-spacing: 3px; text-transform: uppercase; display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 8px; color: #fcd34d; text-shadow: 0 2px 4px rgba(0,0,0,0.8); }
        .jackpot-amount { font-size: 32px; color: #ffffff; display: block; font-weight: 900; text-shadow: 0 2px 15px rgba(251, 191, 36, 0.8); font-family: 'Inter', sans-serif; background: linear-gradient(to bottom, #ffffff, #fcd34d); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        #loginOverlay { position: fixed; inset: 0; background: radial-gradient(circle at top right, #1e293b, #0f172a 70%); z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; overflow: hidden; }
        .login-bg-blob { position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.4; z-index: -1; }
        .blob-1 { width: 300px; height: 300px; background: var(--accent); top: -100px; right: -50px; animation: floatBlob 10s infinite alternate; }
        .blob-2 { width: 250px; height: 250px; background: var(--minigame); bottom: -50px; left: -50px; animation: floatBlob 12s infinite alternate-reverse; }
        @keyframes floatBlob { from { transform: translate(0,0); } to { transform: translate(30px, 50px); } }
        .login-app-container { width: 100%; max-width: 400px; display: flex; flex-direction: column; align-items: center; text-align: center; animation: slideUpFade 0.8s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes slideUpFade { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .app-logo-lg { font-size: 56px; font-weight: 900; letter-spacing: -3px; color: white; margin-bottom: 10px; text-shadow: 0 10px 30px rgba(14, 165, 233, 0.3); }
        .app-logo-lg span { color: var(--accent-glow); }
        .app-tagline { font-size: 16px; color: #cbd5e1; font-weight: 500; margin-bottom: 40px; line-height: 1.5; opacity: 0.9; }
        .promo-badge { background: linear-gradient(90deg, rgba(251, 191, 36, 0.1), rgba(251, 191, 36, 0.2)); border: 1px solid rgba(251, 191, 36, 0.3); color: var(--gold); padding: 8px 16px; border-radius: 20px; font-size: 12px; font-weight: 800; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 30px; display: flex; align-items: center; gap: 8px; box-shadow: 0 0 15px rgba(251, 191, 36, 0.1); }
        .auth-btn-group { width: 100%; display: flex; flex-direction: column; gap: 15px; margin-bottom: 40px; }
        .btn-main-auth { background: white; color: black; border: none; width: 100%; padding: 18px; border-radius: 16px; font-weight: 800; font-size: 16px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 12px; transition: 0.3s; box-shadow: 0 10px 25px rgba(0,0,0,0.3); }
        .btn-main-auth:hover { transform: translateY(-3px); box-shadow: 0 15px 35px rgba(0,0,0,0.4); }
        .btn-sec-auth { background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.2); width: 100%; padding: 18px; border-radius: 16px; font-weight: 700; font-size: 16px; cursor: pointer; backdrop-filter: blur(10px); transition: 0.3s; }
        .btn-sec-auth:hover { background: rgba(255,255,255,0.15); border-color: white; }
        .login-footer-legal { position: absolute; bottom: 20px; left: 0; right: 0; text-align: center; padding: 0 20px; }
        .legal-text { font-size: 10px; color: #64748b; line-height: 1.4; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; display: flex; flex-direction: column; gap: 5px; align-items: center; }
        .nav { background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(15px); padding: 10px 15px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 100; border-bottom: 1px solid rgba(255,255,255,0.1); height: auto; min-height: 60px; }
        .user-stats { display: flex; align-items: center; gap: 8px; }
        .icon-btn { background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.15); width: 38px; height: 38px; border-radius: 12px; cursor: pointer; position: relative; display: flex; align-items: center; justify-content: center; transition: 0.2s; }
        .icon-btn:active { transform: scale(0.95); }
        .notif-badge { position: absolute; top: 8px; right: 8px; background: var(--danger); width: 8px; height: 8px; border-radius: 50%; border: 1px solid var(--surface); display: none; z-index: 10; box-shadow: 0 0 10px var(--danger); }
        .points-badge { background: linear-gradient(135deg, rgba(251, 191, 36, 0.2), rgba(245, 158, 11, 0.4)); color: #fff; padding: 0 12px; height: 38px; border-radius: 12px; font-weight: 800; border: 1px solid rgba(251, 191, 36, 0.6); font-size: 13px; cursor: pointer; display: flex; align-items: center; gap: 6px; text-shadow: 0 1px 2px rgba(0,0,0,0.8); box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3); }
        #userImg { width: 45px; height: 45px; border-radius: 50%; cursor: pointer; border: 2px solid var(--accent); object-fit: cover; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        .disclaimer { background: rgba(239, 68, 68, 1); color: white; padding: 6px 0; font-size: 10px; font-weight: 700; overflow: hidden; white-space: nowrap; border-bottom: 1px solid rgba(255,255,255,0.2); backdrop-filter: blur(5px); text-shadow: 0 1px 2px black; }
        .marquee-content { display: inline-block; animation: marquee 25s linear infinite; padding-left: 100%; }
        @keyframes marquee { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }
        
        /* BOTTOM NAVIGATION - OPTIMIZED FOR MOBILE */
        .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(15px); border-top: 1px solid rgba(255,255,255,0.1); height: 65px; display: flex; justify-content: space-around; align-items: center; z-index: 5000; padding-bottom: env(safe-area-inset-bottom); }
        .nav-item { display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 4px; color: #94a3b8; width: 20%; height: 100%; border: none; background: none; cursor: pointer; transition: 0.2s; }
        .nav-item.active { color: var(--accent-glow); }
        .nav-item.active i { transform: translateY(-2px); }
        .nav-icon { width: 24px; height: 24px; transition: 0.2s; }
        .nav-label { font-size: 10px; font-weight: 700; }
        .nav-center { position: relative; top: -15px; }
        .nav-center .nav-icon-bg { background: linear-gradient(135deg, var(--accent), #2563eb); width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; box-shadow: 0 8px 20px rgba(14, 165, 233, 0.5); border: 4px solid #0f172a; }

        .next-draw-container { background: rgba(15, 23, 42, 0.8); border: 1px solid rgba(251, 191, 36, 0.4); padding: 15px; border-radius: 20px; margin-bottom: 15px; display: flex; align-items: center; gap: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); backdrop-filter: blur(10px); }
        .nd-icon { background: linear-gradient(135deg, rgba(251, 191, 36, 0.2), rgba(245, 158, 11, 0.2)); color: var(--gold); width: 45px; height: 45px; border-radius: 12px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; border: 1px solid rgba(251, 191, 36, 0.4); }
        .nd-info { flex: 1; }
        .next-draw-label { font-size: 11px; font-weight: 800; color: var(--gold); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 2px; }
        .next-draw-time { font-size: 18px; font-weight: 900; color: white; text-shadow: 0 2px 5px rgba(0,0,0,0.8); }
        .container { width: 100%; max-width: 500px; margin: 0 auto; padding: 10px; padding-bottom: 120px; /* Space for Ad + Nav */ }
        .card { background: var(--glass-surface); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border-radius: 24px; padding: 15px; margin-bottom: 20px; border: 1px solid var(--glass-border); position: relative; transition: all 0.3s ease; box-shadow: 0 15px 35px rgba(0,0,0,0.4); }
        
        .video-feed-wrapper { margin-bottom: 15px; border-radius: 24px; overflow: hidden; background: #000; border: 2px solid rgba(255,255,255,0.2); box-shadow: 0 10px 40px rgba(0,0,0,0.6); }
        .video-container { position: relative; width: 100%; aspect-ratio: 16 / 9; }
        .video-overlay-bl { position: absolute; bottom: 12px; left: 12px; z-index: 10; background: rgba(0,0,0,0.9); padding: 6px 12px; border-radius: 8px; border: 1px solid var(--success); display: flex; align-items: center; gap: 5px; color: var(--success); font-size: 11px; font-weight: 800; }
        .draw-panel { display: grid; grid-template-columns: 1fr 90px; gap: 12px; margin-bottom: 20px; }
        .prev-balls { background: rgba(0,0,0,0.4); border-radius: 16px; padding: 10px; display: flex; align-items: center; gap: 8px; overflow-x: auto; scrollbar-width: none; border: 1px solid rgba(255,255,255,0.1); }
        .ball-small { min-width: 40px; height: 40px; background: linear-gradient(135deg, #334155, #1e293b); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 900; border: 1px solid rgba(255,255,255,0.3); color: white; box-shadow: 0 4px 10px rgba(0,0,0,0.3); text-shadow: 0 1px 2px black; }
        .current-ball-box { background: linear-gradient(135deg, var(--accent), #2563eb); border-radius: 18px; height: 90px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: 0 8px 25px rgba(59, 130, 246, 0.5); border: 2px solid rgba(255,255,255,0.4); position: relative; overflow: hidden; }
        .current-ball-box::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent); animation: shine 3s infinite; }
        @keyframes shine { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }
        .bingo-header { display: grid; grid-template-columns: repeat(5, 1fr); gap: 4px; margin-bottom: 10px; }
        .letter { text-align: center; font-size: 24px; font-weight: 900; color: var(--gold); text-shadow: 0 2px 10px rgba(251, 191, 36, 0.8); -webkit-text-stroke: 1px rgba(0,0,0,0.5); }
        .grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 4px; position: relative; }
        .cell { aspect-ratio: 1; background: rgba(255,255,255,0.1); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 16px; border: 1px solid rgba(255,255,255,0.15); transition: all 0.3s; z-index: 2; position: relative; overflow: hidden; box-shadow: inset 0 2px 5px rgba(255,255,255,0.05); color: white; text-shadow: 0 2px 3px black; }
        .card.card-win { border: 3px solid var(--success) !important; box-shadow: 0 0 50px rgba(16, 185, 129, 0.5); animation: pulse-win 2s infinite; background: rgba(16, 185, 129, 0.2); }
        .card.card-lost { opacity: 0.6; filter: grayscale(0.8); pointer-events: none; }
        .card.card-puro { border: 2px solid var(--gold) !important; box-shadow: 0 0 40px rgba(251, 191, 36, 0.4); animation: pulse-gold 1.5s infinite; }
        .cell.cell-waiting { background: #fffbeb !important; color: #b45309 !important; border: 2px dashed #f59e0b; animation: flash-waiting 1s infinite; z-index: 5; font-weight: 900; transform: scale(1.1); box-shadow: 0 0 20px rgba(251, 191, 36, 0.8); text-shadow: none; }
        .cell.win-glow { background: #10b981 !important; color: white; z-index: 3; border: 2px solid #fff; box-shadow: 0 0 25px var(--success), inset 0 0 15px rgba(255,255,255,0.3); animation: popWin 0.4s ease forwards; }
        .cell.win-glow::after { opacity: 0; animation: fadeInLine 0.5s forwards; }
        .cell.win-line-h::after { content:''; position:absolute; top:50%; left:0; right:0; height:6px; background:var(--gold); transform:translateY(-50%); box-shadow:0 0 10px rgba(0,0,0,0.5); z-index:10; border-radius:10px; }
        .cell.win-line-v::after { content:''; position:absolute; top:0; bottom:0; left:50%; width:6px; background:var(--gold); transform:translateX(-50%); box-shadow:0 0 10px rgba(0,0,0,0.5); z-index:10; border-radius:10px; }
        .cell.win-line-d1::after { content:''; position:absolute; top:50%; left:-50%; right:-50%; height:6px; background:var(--gold); transform:translateY(-50%) rotate(45deg); box-shadow:0 0 10px rgba(0,0,0,0.5); z-index:10; }
        .cell.win-line-d2::after { content:''; position:absolute; top:50%; left:-50%; right:-50%; height:6px; background:var(--gold); transform:translateY(-50%) rotate(-45deg); box-shadow:0 0 10px rgba(0,0,0,0.5); z-index:10; }
        .late-overlay, .game-over-overlay { position: absolute; inset: 0; background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); z-index: 100; display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 20px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.2); }
        .late-text { font-weight: 800; font-size: 20px; color: white; margin-bottom: 8px; text-shadow: 0 4px 10px rgba(0,0,0,0.8); }
        .late-subtext { font-size: 14px; opacity: 1; color: #cbd5e1; text-shadow: 0 2px 4px black; }
        #winnerBanner { display: none; background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 15px; border-radius: 16px; text-align: center; font-weight: 900; margin-bottom: 15px; animation: slideDown 0.5s ease; border: 2px solid #a7f3d0; box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4); text-shadow: 0 1px 2px rgba(0,0,0,0.5); }
        .winner-line { font-size: 13px; opacity: 1; margin-top: 5px; display: block; font-weight: 600; }
        @keyframes slideDown { from { transform: translateY(-10px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .chat-box { height: 480px; display: flex; flex-direction: column; background: #111827; border-radius: 20px; border: 1px solid rgba(255,255,255,0.1); overflow: hidden; box-shadow: 0 20px 50px rgba(0,0,0,0.5); position: relative; }
        .chat-header { padding: 15px 20px; background: rgba(31, 41, 55, 0.95); border-bottom: 1px solid rgba(255,255,255,0.08); display: flex; align-items: center; gap: 10px; z-index: 10; box-shadow: 0 2px 10px rgba(0,0,0,0.2); }
        .chat-header h3 { margin: 0; font-size: 14px; font-weight: 800; letter-spacing: 0.5px; color: var(--accent-glow); text-transform: uppercase; }
        #chatList { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 12px; scroll-behavior: smooth; background: #0f172a; }
        .chat-row { display: flex; gap: 10px; max-width: 100%; animation: fadeIn 0.3s ease; align-items: flex-end; }
        .chat-pfp { width: 32px; height: 32px; border-radius: 50%; border: 1px solid rgba(255,255,255,0.2); flex-shrink: 0; object-fit: cover; cursor: pointer; }
        .chat-content { display: flex; flex-direction: column; max-width: 80%; }
        .bubble { padding: 10px 14px; font-size: 13px; line-height: 1.4; color: #e2e8f0; word-break: break-word; font-weight: 500; box-shadow: 0 2px 5px rgba(0,0,0,0.1); position: relative; }
        .chat-row[style*="row-reverse"] .bubble { background: linear-gradient(135deg, var(--accent), #2563eb); color: white; border-radius: 18px 18px 4px 18px; text-shadow: 0 1px 2px rgba(0,0,0,0.2); }
        .chat-row:not([style*="row-reverse"]) .bubble { background: #374151; color: #f3f4f6; border-radius: 18px 18px 18px 4px; border: 1px solid rgba(255,255,255,0.05); }
        .chat-name { font-size: 10px; font-weight: 700; color: #94a3b8; margin-bottom: 4px; cursor:pointer; margin-left: 2px; }
        .chat-row[style*="row-reverse"] .chat-name { display: none; }
        .chat-input-area { background: #1f2937; padding: 12px; border-top: 1px solid rgba(255,255,255,0.08); display: flex; gap: 10px; align-items: center; }
        .input-wrapper { flex: 1; display: flex; gap: 10px; background: #374151; padding: 0 15px; border-radius: 24px; border: 1px solid transparent; transition: 0.3s; align-items: center; height: 42px; }
        .input-wrapper:focus-within { border-color: var(--accent); background: #4b5563; }
        .input-wrapper input { flex: 1; background: none; border: none; color: white; outline: none; font-size: 13px; height: 100%; }
        .send-btn { background: var(--accent); color: white; border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: 0.2s; box-shadow: 0 4px 12px rgba(14, 165, 233, 0.3); }
        .send-btn:hover { transform: scale(1.05); }
        
        /* === PROFESSIONAL MESSENGER FIXES (Layout & Keyboard Issues) === */
        .pm-modal { 
            position: fixed; inset: 0; background: #000000; z-index: 6000; /* Higher than Nav */
            display: none; flex-direction: column; overflow: hidden; 
            height: 100dvh; /* Dynamic viewport height */
        }
        .pm-container { width: 100%; height: 100%; background: #000000; display: flex; flex-direction: column; overflow: hidden; }
        .pm-header { padding: 15px 15px; display: flex; justify-content: space-between; align-items: center; background: #0f172a; border-bottom: 1px solid #1e293b; height: 60px; z-index: 50; flex-shrink: 0; }
        .pm-header h3 { font-size: 22px; font-weight: 800; color: white; }
        .pm-inbox-list { flex: 1; overflow-y: auto; padding: 0; background: #000000; }
        .pm-item { display: flex; align-items: center; gap: 12px; padding: 15px 15px; transition: 0.2s; cursor: pointer; border-bottom: 1px solid #111; }
        .pm-item:hover { background: #111; }
        .pm-avatar { width: 55px; height: 55px; border-radius: 50%; object-fit: cover; }
        .pm-info { flex: 1; display: flex; flex-direction: column; gap: 4px; }
        .pm-name { font-size: 16px; font-weight: 700; color: white; }
        .pm-preview { font-size: 14px; color: #909090; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 250px; }
        
        .pm-chat-view { display: none; flex-direction: column; height: 100%; background: #000000; position: absolute; inset: 0; z-index: 60; }
        .pm-chat-header { display: flex; align-items: center; justify-content:space-between; padding: 10px 15px; border-bottom: 1px solid #1e293b; background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(10px); height: 60px; flex-shrink: 0; }
        .pm-messages { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 4px; background: #000000; padding-bottom: 10px; }
        .msg-bubble { padding: 10px 16px; font-size: 15px; max-width: 75%; word-break: break-word; line-height: 1.4; margin-bottom: 2px; }
        .msg-me { align-self: flex-end; background: var(--messenger-blue); color: white; border-radius: 18px 18px 4px 18px; }
        .msg-them { align-self: flex-start; background: var(--messenger-grey); color: white; border-radius: 18px 18px 18px 4px; }
        
        /* Fixed Input Area */
        .pm-input-area { 
            padding: 10px; background: #0f172a; display: flex; gap: 10px; align-items: center; 
            border-top: 1px solid #1e293b; 
            padding-bottom: calc(10px + env(safe-area-inset-bottom)); 
            flex-shrink: 0;
            position: relative; /* Ensure it stays in flow or fixed depending on need */
        }
        .pm-styled-input { flex: 1; background: #1e293b; border: 1px solid #334155; padding: 12px 20px; border-radius: 25px; color: white; font-size: 15px; outline: none; height: 45px; }
        
        .unread-dot { width: 12px; height: 12px; background: var(--messenger-blue); border-radius: 50%; display: inline-block; box-shadow: 0 0 5px var(--messenger-blue); }
        
        /* PWA Banner */
        #pwaInstallBanner { position: fixed; bottom: 80px; left: 0; right: 0; background: linear-gradient(135deg, #0f172a, #1e293b); border-top: 1px solid rgba(255,255,255,0.2); padding: 15px 20px; display: none; align-items: center; justify-content: space-between; z-index: 9999; box-shadow: 0 -10px 30px rgba(0,0,0,0.8); animation: slideUp 0.5s ease; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .pwa-text { font-size: 14px; font-weight: 800; color: white; }
        .pwa-sub { font-size: 11px; color: #cbd5e1; display: block; }
        .pwa-btn { background: var(--accent); color: white; border: none; padding: 10px 20px; border-radius: 12px; font-weight: 900; font-size: 13px; cursor: pointer; box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4); }
        .install-tabs { display: flex; gap: 10px; margin-bottom: 20px; background: rgba(0,0,0,0.3); padding: 5px; border-radius: 12px; }
        .install-tab-btn { flex: 1; padding: 10px; border: none; background: transparent; color: #94a3b8; font-weight: 800; border-radius: 8px; cursor: pointer; }
        .install-tab-btn.active { background: var(--accent); color: white; }
        .guide-step { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; background: rgba(255,255,255,0.05); padding: 15px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.1); }
        .step-num { width: 30px; height: 30px; background: var(--gold); color: black; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 900; flex-shrink: 0; }
        .step-text { font-size: 13px; line-height: 1.4; color: #e2e8f0; }
        #customConfirmModal { position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 100000; display: none; align-items: center; justify-content: center; padding: 20px; backdrop-filter: blur(10px); }
        .conf-content { background: rgba(30, 41, 59, 0.95); border: 1px solid rgba(255,255,255,0.2); border-radius: 24px; padding: 25px; width: 100%; max-width: 320px; text-align: center; box-shadow: 0 25px 60px rgba(0,0,0,0.8); transform: scale(0.9); animation: popScale 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        .conf-title { font-size: 18px; font-weight: 900; color: white; margin: 0 0 10px 0; }
        .conf-msg { font-size: 13px; color: #cbd5e1; margin-bottom: 25px; line-height: 1.5; }
        .conf-actions { display: flex; gap: 10px; justify-content: center; }
        .btn-conf-yes { background: var(--accent); color: white; flex: 1; padding: 12px; border: none; border-radius: 12px; font-weight: 800; cursor: pointer; box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4); }
        .btn-conf-no { background: rgba(255,255,255,0.1); color: #94a3b8; flex: 1; padding: 12px; border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; font-weight: 800; cursor: pointer; }
        #grandJackpotModal { position: fixed; inset: 0; z-index: 99999; background: rgba(0,0,0,0.95); display: none; align-items: center; justify-content: center; flex-direction: column; overflow: hidden; perspective: 1000px; }
        .jackpot-rays { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 200vmax; height: 200vmax; background: conic-gradient(from 0deg, transparent 0deg, rgba(251, 191, 36, 0.1) 10deg, transparent 20deg, rgba(251, 191, 36, 0.1) 30deg, transparent 40deg, rgba(251, 191, 36, 0.1) 50deg, transparent 60deg, rgba(251, 191, 36, 0.1) 70deg, transparent 80deg, rgba(251, 191, 36, 0.1) 90deg, transparent 100deg, rgba(251, 191, 36, 0.1) 110deg, transparent 120deg, rgba(251, 191, 36, 0.1) 130deg, transparent 140deg, rgba(251, 191, 36, 0.1) 150deg, transparent 160deg, rgba(251, 191, 36, 0.1) 170deg, transparent 180deg, rgba(251, 191, 36, 0.1) 190deg, transparent 200deg, rgba(251, 191, 36, 0.1) 210deg, transparent 220deg, rgba(251, 191, 36, 0.1) 230deg, transparent 240deg, rgba(251, 191, 36, 0.1) 250deg, transparent 260deg, rgba(251, 191, 36, 0.1) 270deg, transparent 280deg, rgba(251, 191, 36, 0.1) 290deg, transparent 300deg, rgba(251, 191, 36, 0.1) 310deg, transparent 320deg, rgba(251, 191, 36, 0.1) 330deg, transparent 340deg, rgba(251, 191, 36, 0.1) 350deg, transparent 360deg); animation: spinRays 20s linear infinite; pointer-events: none; }
        @keyframes spinRays { from { transform: translate(-50%, -50%) rotate(0deg); } to { transform: translate(-50%, -50%) rotate(360deg); } }
        .jackpot-content { position: relative; z-index: 10; text-align: center; animation: jpPopIn 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes jpPopIn { 0% { transform: scale(0); opacity: 0; } 100% { transform: scale(1); opacity: 1; } 100% { transform: scale(1); opacity: 1; } }
        .jp-title { font-size: 40px; font-weight: 900; color: #fbbf24; text-transform: uppercase; letter-spacing: 2px; text-shadow: 0 0 20px rgba(251, 191, 36, 0.8), 0 0 40px rgba(251, 191, 36, 0.4); margin-bottom: 10px; animation: pulseText 1s infinite alternate; }
        .jp-amount { font-size: 56px; font-weight: 900; color: white; background: linear-gradient(135deg, #fff, #fcd34d); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-shadow: 0 10px 30px rgba(0,0,0,0.5); margin: 0; line-height: 1; }
        .jp-name { font-size: 18px; color: #cbd5e1; margin-top: 15px; font-weight: 600; letter-spacing: 1px; text-transform: uppercase; }
        .icon-glow { filter: drop-shadow(0 0 20px rgba(251, 191, 36, 0.8)); animation: bounceIcon 2s infinite ease-in-out; color: #fbbf24; }
        @keyframes bounceIcon { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }
        @keyframes pulseText { from { transform: scale(1); } to { transform: scale(1.05); } }
        @keyframes pulse-ring { 0% { box-shadow: 0 0 0 0 rgba(255,255,255,0.1); } 70% { box-shadow: 0 0 0 15px rgba(255,255,255,0); } 100% { box-shadow: 0 0 0 0 rgba(255,255,255,0); } }
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 6000; display: none; align-items: center; justify-content: center; padding: 15px; backdrop-filter: blur(15px); }
        .modal-content { background: rgba(30, 41, 59, 0.95); border-radius: 30px; width: 100%; max-width: 450px; padding: 25px; border: 1px solid rgba(255,255,255,0.2); max-height: 90vh; overflow-y: auto; box-shadow: 0 25px 60px rgba(0,0,0,0.8); -webkit-backdrop-filter: blur(20px); backdrop-filter: blur(20px); }
        .reward-grid { display: grid; grid-template-columns: 1fr; gap: 15px; margin-top: 20px; }
        .reward-item { background: linear-gradient(145deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05)); padding: 18px; border-radius: 20px; display: flex; justify-content: space-between; align-items: center; border: 1px solid rgba(255,255,255,0.15); transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .reward-item:hover { transform: translateY(-3px); border-color: var(--accent); box-shadow: 0 10px 25px rgba(59, 130, 246, 0.2); }
        .reward-main { display: flex; align-items: center; gap: 15px; }
        .reward-icon-box { width: 45px; height: 45px; background: rgba(59, 130, 246, 0.2); border-radius: 14px; display: flex; align-items: center; justify-content: center; color: var(--accent-glow); border: 1px solid rgba(59, 130, 246, 0.3); }
        .reward-info b { font-size: 16px; display: block; color: white; letter-spacing: 0.3px; text-shadow: 0 2px 2px black; }
        .reward-info small { color: var(--gold); font-weight: 800; font-size: 12px; display: flex; align-items: center; gap: 4px; margin-top: 2px; }
        .btn-redeem { background: linear-gradient(135deg, var(--accent), #2563eb); color: white; border: none; padding: 10px 18px; border-radius: 12px; font-weight: 800; font-size: 13px; cursor: pointer; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3); transition: 0.2s; text-shadow: 0 1px 2px black; }
        .btn-redeem:active { transform: scale(0.95); }
        
        /* === PROFESSIONAL PROFILE PAGE (REDESIGNED) === */
        .profile-page-container { position: fixed; inset: 0; background: #020617; z-index: 6000; display: none; flex-direction: column; overflow-y: auto; padding-bottom: 80px; }
        .profile-cover {
            height: 220px;
            background-size: cover;
            background-position: center;
            position: relative;
            background-color: #334155;
        }
        .profile-cover::after {
            content: ''; position: absolute; inset: 0; background: linear-gradient(to bottom, transparent 40%, rgba(2,6,23,0.9));
        }
        .profile-nav-back {
            position: absolute; top: 15px; left: 15px; z-index: 20;
            width: 40px; height: 40px; border-radius: 50%; background: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px); border: 1px solid rgba(255,255,255,0.2);
            color: white; display: flex; align-items: center; justify-content: center; cursor: pointer;
        }
        .profile-info-section {
            padding: 0 20px;
            margin-top: -70px; /* Overlap cover */
            position: relative;
            z-index: 10;
        }
        .profile-header-row {
            display: flex; justify-content: flex-start; align-items: flex-end; margin-bottom: 10px; gap: 15px;
        }
        .profile-page-img {
            width: 120px; height: 120px;
            border-radius: 50%;
            border: 5px solid #020617;
            object-fit: cover;
            background: #0f172a;
            box-shadow: 0 4px 25px rgba(0,0,0,0.6);
        }
        .profile-action-btn {
            padding: 8px 24px;
            background: var(--text);
            color: black;
            border: none;
            border-radius: 25px;
            font-size: 14px; font-weight: 800; 
            cursor: pointer; box-shadow: 0 5px 15px rgba(255,255,255,0.1);
            transition: 0.2s; margin-bottom: 15px; /* Aligned with bottom of image */
        }
        .profile-action-btn.secondary { background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); box-shadow: none; color: white; }
        
        .profile-page-name { font-size: 28px; font-weight: 900; color: white; margin-bottom: 5px; letter-spacing: -0.5px; display:flex; align-items:center; gap:8px; }
        .profile-page-bio { font-size: 15px; color: #94a3b8; margin-bottom: 25px; line-height: 1.5; max-width: 95%; }
        
        .profile-stats { display: flex; gap: 0; margin-bottom: 20px; padding: 15px 0; border-top: 1px solid rgba(255,255,255,0.08); border-bottom: 1px solid rgba(255,255,255,0.08); }
        .stat-item { text-align: left; margin-right: 35px; }
        .stat-val { font-size: 18px; font-weight: 900; color: white; }
        .stat-lbl { font-size: 13px; color: #64748b; font-weight: 500; }
        
        .profile-feed-section {
            padding: 0 5px;
            margin-top: 10px;
        }
        .profile-header { display: flex; align-items: center; gap: 15px; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .profile-img-large { width: 70px; height: 70px; border-radius: 22px; border: 3px solid var(--accent); box-shadow: 0 0 20px rgba(59, 130, 246, 0.3); object-fit: cover; }
        .profile-name-info { flex: 1; }
        .profile-name { font-size: 20px; font-weight: 900; margin: 0; text-shadow: 0 2px 4px rgba(0,0,0,0.8); }
        .profile-uid { font-size: 11px; opacity: 0.8; text-transform: uppercase; letter-spacing: 1px; color: #cbd5e1; }
        .gcash-section { background: rgba(59, 130, 246, 0.15); padding: 15px; border-radius: 18px; margin-bottom: 15px; border: 1px solid rgba(59, 130, 246, 0.3); }
        .styled-input { width: 100%; background: rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.2); padding: 12px 15px; border-radius: 12px; color: white; font-weight: 700; outline: none; font-size: 14px; box-shadow: inset 0 2px 5px rgba(0,0,0,0.3); text-shadow: none; }
        .styled-input:focus { border-color: var(--accent); background: rgba(0,0,0,0.6); }
        .ref-container { background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(59, 130, 246, 0.15)); border: 1px solid rgba(16, 185, 129, 0.3); padding: 15px; border-radius: 18px; margin-bottom: 15px; }
        .history-box { margin-top: 20px; background: rgba(0,0,0,0.3); border-radius: 20px; padding: 18px; border: 1px solid rgba(255,255,255,0.1); }
        .history-list { max-height: 250px; overflow-y: auto; padding-right: 5px; }
        .history-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .btn-change { background: rgba(59, 130, 246, 0.2); color: var(--accent-glow); border: 1px solid var(--accent); height: 40px; padding: 0 15px; border-radius: 12px; font-size: 11px; font-weight: 800; cursor: pointer; display: flex; align-items: center; gap: 5px; transition: 0.2s; box-shadow: 0 4px 10px rgba(0,0,0,0.2); text-shadow: 0 1px 2px black; }
        .btn-change:hover { background: var(--accent); color: white; }
        .btn-change:disabled { opacity: 0.5; cursor: not-allowed; border-color: #475569; color: #94a3b8; background: none; }
        .pattern-box { background: rgba(0,0,0,0.4); height: 40px; padding: 0 15px; border-radius: 12px; display: flex; align-items: center; gap: 8px; border: 1px solid rgba(255,255,255,0.1); backdrop-filter: blur(5px); }
        .pattern-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--gold); box-shadow: 0 0 10px var(--gold); }
        .pattern-text { font-size: 11px; font-weight: 800; color: var(--gold); text-transform: uppercase; letter-spacing: 0.5px; }
        .notif-card-new { background: rgba(255,255,255,0.1); padding: 15px; border-radius: 16px; margin-bottom: 12px; border: 1px solid rgba(255,255,255,0.15); position: relative; transition: 0.2s; backdrop-filter: blur(5px); }
        .notif-card-new:hover { background: rgba(255,255,255,0.15); border-color: var(--accent); }
        .notif-header-new { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .notif-title { font-size: 12px; font-weight: 800; color: var(--accent-glow); display: flex; align-items: center; gap: 5px; }
        .notif-time { font-size: 10px; opacity: 0.6; color: #cbd5e1; }
        .notif-body { font-size: 13px; line-height: 1.5; color: #ffffff; text-shadow: 0 1px 2px black; }
        .btn-del-notif { background: none; border: none; color: #94a3b8; cursor: pointer; padding: 4px; transition: 0.2s; }
        .btn-del-notif:hover { color: var(--danger); }
        .result-modal { position: absolute; inset: 0; background: rgba(0,0,0,0.85); display: none; align-items: center; justify-content: center; flex-direction: column; z-index: 50; border-radius: 30px; backdrop-filter: blur(8px); animation: fadeIn 0.3s; }
        .res-title { font-size: 38px; font-weight: 900; margin-bottom: 5px; text-transform: uppercase; letter-spacing: 1px; }
        .res-win { color: #fbbf24; text-shadow: 0 0 30px #fbbf24; }
        .res-loss { color: #ef4444; text-shadow: 0 0 20px rgba(239, 68, 68, 0.5); }
        .res-pts { font-size: 16px; color: white; opacity: 1; margin-bottom: 25px; text-shadow: 0 2px 4px black; }
        .btn-play-again { background: white; color: black; border: none; padding: 12px 25px; border-radius: 30px; font-weight: 900; font-size: 12px; cursor: pointer; box-shadow: 0 0 20px rgba(255,255,255,0.3); transition: 0.2s; }
        .btn-play-again:hover { transform: scale(1.1); box-shadow: 0 0 30px rgba(255,255,255,0.5); }
        @keyframes blink { from { opacity: 0.5; } to { opacity: 1; } }

        /* === NEW SOCIAL ECOSYSTEM STYLES === */
        .social-feed-container { margin-top: 15px; display: flex; flex-direction: column; gap: 15px; }
        
        /* Post Creator Redesign (Professional) */
        .post-creator { background: var(--glass-surface); padding: 15px; border-radius: 18px; border: 1px solid var(--glass-border); display: flex; flex-direction: column; gap: 15px; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .post-creator-top { display: flex; gap: 12px; }
        .post-creator-avatar { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 1px solid rgba(255,255,255,0.2); }
        .post-input { flex: 1; background: transparent; border: none; color: white; resize: none; min-height: 50px; font-family: 'Inter', sans-serif; font-size: 14px; outline: none; }
        .post-creator-divider { height: 1px; background: rgba(255,255,255,0.1); width: 100%; }
        .post-creator-actions { display: flex; justify-content: space-between; align-items: center; }
        .post-tool-btn { background: none; border: none; display: flex; align-items: center; gap: 6px; color: #94a3b8; font-weight: 700; font-size: 12px; cursor: pointer; transition: 0.2s; padding: 8px 12px; border-radius: 8px; }
        .post-tool-btn:hover { background: rgba(255,255,255,0.05); color: var(--accent-glow); }
        
        .mood-selector { display: flex; gap: 5px; overflow-x: auto; padding-bottom: 5px; }
        .mood-chip { padding: 6px 12px; background: rgba(255,255,255,0.1); border-radius: 20px; font-size: 11px; font-weight: 700; cursor: pointer; border: 1px solid transparent; transition: 0.2s; white-space: nowrap; }
        .mood-chip.active { background: var(--accent); color: white; border-color: var(--accent-glow); }
        .btn-post { background: var(--accent); color: white; border: none; padding: 8px 20px; border-radius: 20px; font-weight: 800; cursor: pointer; font-size: 12px; box-shadow: 0 4px 10px rgba(14, 165, 233, 0.3); }
        
        /* Post Card */
        .post-card { background: #1e293b; border-radius: 16px; border: 1px solid rgba(255,255,255,0.05); overflow: hidden; margin-bottom: 10px; }
        .post-header { padding: 12px; display: flex; align-items: center; gap: 10px; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .post-avatar { width: 36px; height: 36px; border-radius: 50%; object-fit: cover; border: 1px solid rgba(255,255,255,0.2); cursor: pointer; }
        .post-meta { flex: 1; }
        .post-author { font-size: 13px; font-weight: 800; color: white; display: flex; align-items: center; gap: 5px; }
        .friend-badge { background: var(--gold); color: black; font-size: 8px; padding: 2px 4px; border-radius: 4px; text-transform: uppercase; font-weight: 900; }
        .post-time { font-size: 10px; color: #94a3b8; }
        .mood-display { font-size: 10px; background: rgba(255,255,255,0.1); padding: 2px 8px; border-radius: 8px; margin-top: 2px; display: inline-block; color: var(--accent-glow); }
        
        .post-content { padding: 15px; font-size: 13px; line-height: 1.5; color: #e2e8f0; word-break: break-word; }
        .post-image-container { width: 100%; max-height: 300px; overflow: hidden; display: flex; justify-content: center; background: #000; margin-bottom: 10px; }
        .post-image { max-width: 100%; max-height: 300px; object-fit: contain; }
        
        .post-stats { padding: 8px 15px; font-size: 11px; color: #94a3b8; border-bottom: 1px solid rgba(255,255,255,0.05); display: flex; justify-content: space-between; }

        .post-actions { display: flex; padding: 5px; position: relative; }
        .action-btn { flex: 1; background: transparent; border: none; color: #94a3b8; padding: 10px; font-size: 12px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 6px; transition: 0.2s; border-radius: 8px; }
        .action-btn:hover { background: rgba(255,255,255,0.05); color: white; }
        .action-btn.active { color: var(--accent); }
        
        /* Reaction Popup */
        .reaction-popup {
            position: absolute; bottom: 45px; left: 10px;
            background: white; border-radius: 30px; padding: 5px;
            display: none; gap: 5px; box-shadow: 0 5px 20px rgba(0,0,0,0.5);
            animation: popUp 0.2s ease; z-index: 20;
        }
        @keyframes popUp { from { transform: scale(0); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .reaction-icon { font-size: 20px; cursor: pointer; transition: transform 0.2s; padding: 2px; }
        .reaction-icon:hover { transform: scale(1.3); }
        
        .post-comment-preview {
            background: rgba(0,0,0,0.2); padding: 10px; margin: 0 10px 10px 10px; border-radius: 10px;
            font-size: 11px; color: #cbd5e1;
        }
        .post-comment-preview b { color: white; margin-right: 5px; }

        /* Friend Request Notification in Feed */
        .friend-req-card { background: rgba(14, 165, 233, 0.1); border: 1px solid var(--accent); padding: 12px; border-radius: 12px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .req-info { display: flex; align-items: center; gap: 10px; }
        .req-actions { display: flex; gap: 5px; }
        .btn-accept { background: var(--success); color: white; border: none; padding: 6px 12px; border-radius: 8px; font-weight: 700; font-size: 11px; cursor: pointer; }
        .btn-decline { background: rgba(255,255,255,0.1); color: white; border: none; padding: 6px 12px; border-radius: 8px; font-weight: 700; font-size: 11px; cursor: pointer; }

        /* User Options Modal */
        .user-opt-btn { width: 100%; padding: 15px; border: none; background: rgba(255,255,255,0.05); color: white; font-weight: 700; margin-bottom: 8px; border-radius: 12px; text-align: left; display: flex; align-items: center; gap: 10px; cursor: pointer; }
        .user-opt-btn:hover { background: rgba(255,255,255,0.1); }

        /* UPDATED MESSENGER STYLES */
        .active-friends-bar {
            display: flex; gap: 15px; overflow-x: auto; padding: 15px; background: #0f172a; border-bottom: 1px solid #1e293b; scrollbar-width: none; flex-shrink: 0;
        }
        .active-friend-item {
            display: flex; flex-direction: column; align-items: center; min-width: 60px; cursor: pointer;
        }
        .active-img-wrap { position: relative; width: 50px; height: 50px; }
        .active-img { width: 50px; height: 50px; border-radius: 50%; border: 2px solid var(--messenger-blue); object-fit: cover; }
        .online-dot-large { position: absolute; bottom: 2px; right: 2px; width: 12px; height: 12px; background: #31a24c; border: 2px solid #000; border-radius: 50%; }
        .active-name { font-size: 11px; color: #e4e6eb; margin-top: 5px; max-width: 60px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }

        /* NEW BOTTOM SHEET COMMENTS STYLE (TIKTOK/FB STYLE) */
        .comment-modal { 
            position: fixed; inset: auto; bottom: 0; left: 0; right: 0; height: 70vh; 
            background: #1e293b; z-index: 7000; display: none; flex-direction: column; 
            border-radius: 20px 20px 0 0; border-top: 1px solid rgba(255,255,255,0.1);
            animation: slideUpModal 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: 0 -10px 50px rgba(0,0,0,0.5);
        }
        @keyframes slideUpModal { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .comment-modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.7); z-index: 6999; display: none; backdrop-filter: blur(2px); }

        .comment-header { padding: 15px; background: #1e293b; border-bottom: 1px solid rgba(255,255,255,0.1); display: flex; justify-content: space-between; align-items: center; border-radius: 20px 20px 0 0; }
        .comment-list { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 15px; }
        .comment-item { display: flex; gap: 10px; align-items: flex-start; }
        .comment-avatar { width: 32px; height: 32px; border-radius: 50%; flex-shrink: 0; }
        .comment-content-block { display: flex; flex-direction: column; max-width: 85%; }
        .comment-bubble { background: #334155; padding: 8px 12px; border-radius: 12px; margin-bottom: 2px; }
        .comment-author { font-size: 11px; font-weight: 800; color: white; margin-bottom: 2px; display: flex; align-items: center; gap: 5px; }
        .comment-text { font-size: 13px; color: #cbd5e1; word-break: break-word; }
        .comment-actions { display: flex; gap: 15px; font-size: 10px; font-weight: 700; color: #94a3b8; padding-left: 5px; }
        .cmt-action-btn { background: none; border: none; padding: 0; color: #94a3b8; font-size: 10px; font-weight: 700; cursor: pointer; }
        .cmt-action-btn:hover { color: white; }
        
        .comment-input-area { padding: 10px; background: #1e293b; display: flex; gap: 10px; border-top: 1px solid rgba(255,255,255,0.05); padding-bottom: calc(10px + env(safe-area-inset-bottom)); }
        .comment-input { flex: 1; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); padding: 10px 15px; border-radius: 20px; color: white; outline: none; }

        .image-preview-container { display: none; position: relative; margin-bottom: 10px; }
        .image-preview-img { max-height: 100px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); }
        .btn-remove-img { position: absolute; top: -5px; right: -5px; background: red; color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; cursor: pointer; border: 1px solid white; font-size: 12px; }

        /* EDIT PROFILE MODAL */
        .edit-input { width: 100%; background: #334155; border: 1px solid rgba(255,255,255,0.1); padding: 12px; border-radius: 12px; color: white; margin-bottom: 15px; outline: none; }
        .edit-label { font-size: 11px; color: #94a3b8; margin-bottom: 5px; display: block; font-weight: 700; text-transform: uppercase; }

        /* SEARCH MODAL */
        .search-modal-container { position: fixed; inset: 0; background: #0f172a; z-index: 7000; display: none; flex-direction: column; }
        .search-header { padding: 15px; background: #1e293b; display: flex; gap: 10px; align-items: center; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .search-bar-wrap { flex: 1; background: rgba(0,0,0,0.3); border-radius: 20px; padding: 8px 15px; display: flex; align-items: center; gap: 8px; border: 1px solid rgba(255,255,255,0.1); }
        .search-input { background: none; border: none; color: white; outline: none; width: 100%; font-size: 14px; }
        .search-results { flex: 1; overflow-y: auto; padding: 15px; }
        .search-res-item { display: flex; align-items: center; gap: 12px; padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05); cursor: pointer; }
        .search-res-img { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; }

        /* VIEW TOGGLING */
        #view-home, #view-bingo { display: none; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* === BADGE TIER SYSTEM === */
        .badge-tier { display: inline-flex; align-items: center; justify-content: center; margin-left: 4px; vertical-align: middle; }
        .badge-icon { width: 14px; height: 14px; fill: currentColor; }
        .tier-bronze { color: #cd7f32; filter: drop-shadow(0 0 2px #cd7f32); }
        .tier-silver { color: #c0c0c0; filter: drop-shadow(0 0 2px #c0c0c0); }
        .tier-gold { color: #ffd700; filter: drop-shadow(0 0 4px #ffd700); }
        .tier-platinum { color: #e5e4e2; filter: drop-shadow(0 0 5px #ffffff); }
        .tier-diamond { color: #b9f2ff; filter: drop-shadow(0 0 8px #00e5ff); animation: pulseDiamond 2s infinite; }
        @keyframes pulseDiamond { 0% { opacity: 0.8; } 50% { opacity: 1; text-shadow: 0 0 10px #00e5ff; } 100% { opacity: 0.8; } }

        /* === PEOPLE YOU MAY KNOW (PYMK) === */
        .pymk-section { margin-bottom: 20px; }
        .pymk-title { padding: 0 5px; margin-bottom: 10px; font-size: 14px; font-weight: 800; color: #cbd5e1; }
        .pymk-scroll { display: flex; gap: 12px; overflow-x: auto; padding-bottom: 10px; scrollbar-width: none; }
        .pymk-card { background: #1e293b; border: 1px solid rgba(255,255,255,0.05); min-width: 140px; width: 140px; padding: 15px; border-radius: 16px; display: flex; flex-direction: column; align-items: center; text-align: center; position: relative; }
        .pymk-img { width: 60px; height: 60px; border-radius: 50%; object-fit: cover; margin-bottom: 10px; border: 2px solid rgba(255,255,255,0.1); }
        .pymk-name { font-size: 13px; font-weight: 700; color: white; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; width: 100%; margin-bottom: 8px; }
        .btn-add-friend-sm { background: rgba(14, 165, 233, 0.2); color: var(--accent-glow); border: 1px solid var(--accent); padding: 6px 12px; border-radius: 20px; font-size: 11px; font-weight: 800; cursor: pointer; width: 100%; }
        .btn-add-friend-sm:hover { background: var(--accent); color: white; }

        /* === NEW MODERN PROFILE STYLES (Added to end) === */
        .rb-profile-modal {
            position: fixed; inset: 0; z-index: 7000;
            background: #0f172a; /* Fallback */
            background: rgba(15, 23, 42, 0.98); 
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            display: none; 
            overflow-y: auto;
            animation: fadeIn 0.3s ease;
        }

        .rb-profile-content {
            width: 100%; max-width: 500px; margin: 0 auto;
            padding-bottom: 80px; position: relative;
        }

        /* Cover & Header */
        .rb-cover-area {
            height: 200px;
            background: linear-gradient(180deg, var(--accent) 0%, #0f172a 100%);
            position: relative;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .rb-cover-overlay {
            position: absolute; inset: 0;
            background-image: radial-gradient(circle at top right, rgba(251, 191, 36, 0.3), transparent 70%);
        }

        .rb-nav-top {
            position: absolute; top: 15px; left: 15px; right: 15px;
            display: flex; justify-content: space-between; z-index: 20;
        }

        .rb-btn-icon {
            width: 40px; height: 40px;
            background: rgba(0,0,0,0.4);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            color: white;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
            backdrop-filter: blur(5px);
            transition: 0.2s;
        }
        .rb-btn-icon:active { transform: scale(0.95); }

        /* Floating Glass Card */
        .rb-user-card {
            margin: -60px 15px 15px 15px;
            background: rgba(30, 41, 59, 0.7); /* Glass Surface */
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border-radius: 24px;
            padding: 20px;
            text-align: center;
            position: relative;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        /* Avatar Styling */
        .rb-avatar-wrap {
            width: 110px; height: 110px;
            margin: -75px auto 10px auto; 
            position: relative;
        }

        .rb-avatar-img {
            width: 100%; height: 100%;
            border-radius: 50%;
            border: 4px solid #0f172a; 
            box-shadow: 0 0 25px rgba(14, 165, 233, 0.5);
            object-fit: cover;
            background: #0f172a;
        }

        .rb-vip-badge {
            position: absolute; bottom: 5px; right: 0;
            background: var(--gold); color: black;
            width: 32px; height: 32px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            border: 3px solid #0f172a;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            z-index: 5;
        }

        /* Typography */
        .rb-name { 
            font-size: 24px; font-weight: 900; color: white; margin-bottom: 2px; 
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }
        .rb-uid { 
            font-size: 11px; color: var(--accent-glow); 
            letter-spacing: 1px; text-transform: uppercase; font-weight: 800; 
            margin-bottom: 15px; opacity: 0.8;
        }
        .rb-bio {
            font-size: 13px; color: #cbd5e1; line-height: 1.5; margin-bottom: 25px;
            font-style: italic; padding: 0 10px;
        }

        /* Stats Row */
        .rb-stats-row {
            display: flex; justify-content: space-around;
            padding: 15px 0;
            background: rgba(0,0,0,0.2);
            border-radius: 16px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .rb-stat-box { display: flex; flex-direction: column; gap: 2px; }
        .rb-stat-num { font-size: 18px; font-weight: 900; color: white; }
        .rb-stat-label { font-size: 9px; color: #94a3b8; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }

        /* Buttons */
        .rb-actions { display: flex; gap: 10px; justify-content: center; }

        .rb-btn-primary {
            flex: 1;
            background: linear-gradient(135deg, var(--accent), #2563eb);
            color: white; border: none;
            padding: 12px; border-radius: 14px;
            font-weight: 800; font-size: 13px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
            display: flex; align-items: center; justify-content: center; gap: 8px;
            transition: 0.2s;
        }
        .rb-btn-primary:active { transform: scale(0.95); }

        .rb-btn-secondary {
            flex: 1;
            background: rgba(255,255,255,0.05);
            color: white; border: 1px solid rgba(255,255,255,0.1);
            padding: 12px; border-radius: 14px;
            font-weight: 800; font-size: 13px;
            cursor: pointer;
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }

        /* Tabs */
        .rb-tabs-container { padding: 0 20px; margin-top: 10px; }
        .rb-tabs-header {
            display: flex; gap: 20px; margin-bottom: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .rb-tab-item {
            padding: 10px 5px;
            font-size: 12px; font-weight: 800; color: #64748b;
            cursor: pointer; position: relative; transition: 0.2s;
        }
        .rb-tab-item.active { color: var(--gold); }
        .rb-tab-item.active::after {
            content: ''; position: absolute; bottom: -1px; left: 0; right: 0;
            height: 3px; background: var(--gold);
            box-shadow: 0 -2px 10px rgba(251, 191, 36, 0.5);
            border-radius: 10px 10px 0 0;
        }
    </style>
</head>
<body>
    <div class="bottom-nav">
    <button class="nav-item active" onclick="switchTab('home')" id="nav-home">
        <i data-lucide="home" class="nav-icon"></i>
        <span class="nav-label">Home</span>
    </button>
    <button class="nav-item" onclick="switchTab('bingo')" id="nav-bingo">
        <i data-lucide="play-circle" class="nav-icon"></i>
        <span class="nav-label">Bingo</span>
    </button>
    <div class="nav-center" onclick="openPostCreator()">
        <div class="nav-icon-bg"><i data-lucide="plus" style="width:28px; height:28px;"></i></div>
    </div>
    <button class="nav-item" onclick="document.getElementById('storeModal').style.display='flex'" id="nav-store">
        <i data-lucide="shopping-bag" class="nav-icon"></i>
        <span class="nav-label">Store</span>
    </button>
    <button class="nav-item" onclick="openMyProfile()" id="nav-profile"> <i data-lucide="user" class="nav-icon"></i>
        <span class="nav-label">Me</span>
    </button>
</div>

<div class="sticky-ad-footer">
    <script type="text/javascript">
        atOptions = { 'key' : 'a664bf7e7084386b4f4b428590030df3', 'format' : 'iframe', 'height' : 50, 'width' : 320, 'params' : {} };
    </script>
    <script type="text/javascript" src="https://pl28660496.effectivegatecpm.com/a6/64/bf/a664bf7e7084386b4f4b428590030df3.js"></script>
</div>

<div id="customPopupBanner">
    <div style="position:relative; max-width:400px; width:100%; animation: popScale 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);">
        <button onclick="closeCustomBanner()" style="position:absolute; top:-15px; right:-10px; background:linear-gradient(135deg, #ef4444, #b91c1c); color:white; border:2px solid white; border-radius:50%; width:36px; height:36px; font-weight:bold; cursor:pointer; z-index:10; display:flex; align-items:center; justify-content:center; box-shadow:0 4px 10px rgba(0,0,0,0.3);"><i data-lucide="x" style="width:20px"></i></button>
        <img id="customBannerImg" src="" style="width:100%; border-radius:20px; border:2px solid rgba(255,255,255,0.2); box-shadow:0 20px 50px rgba(0,0,0,0.8); cursor:pointer; object-fit:cover;" onclick="clickCustomBanner()">
    </div>
</div>

<div id="installGate">
    <div class="gate-logo">RB<span>LIVE</span></div>
    <div class="gate-title">Install to Play</div>
    <p class="gate-desc">To access the full Radio Bingo experience, you must install the official App.</p>
    <button id="gateInstallBtn" class="gate-btn-install" onclick="triggerInstall()">
        <i data-lucide="download-cloud" style="width:20px; height:20px;"></i> INSTALL APP
    </button>
    <div id="gateIosNote" class="gate-ios-note">
        <div style="font-weight:800; color:white; margin-bottom:10px; text-transform:uppercase;">iOS Instructions:</div>
        <div class="ios-step"><i data-lucide="share" class="ios-icon" style="width:16px;"></i> 1. Tap the Share button below.</div>
        <div class="ios-step"><i data-lucide="plus-square" class="ios-icon" style="width:16px;"></i> 2. Scroll down & tap 'Add to Home Screen'.</div>
        <div class="ios-step"><i data-lucide="check" class="ios-icon" style="width:16px;"></i> 3. Launch App from Home Screen.</div>
    </div>
</div>

<div id="notifBlocker">
    <div class="notif-gate-icon">
        <i data-lucide="bell-ring" style="width: 40px; height: 40px; color: #3b82f6;"></i>
    </div>
    <div class="notif-gate-title">ENABLE NOTIFICATIONS</div>
    <p class="notif-gate-desc">To ensure fairness and real-time updates for Bingo Calls, this app requires push notifications to be enabled.</p>
    <button onclick="requestGatePermission()" class="btn-allow-notif">
        <i data-lucide="check-circle" style="width:20px"></i> ALLOW NOTIFICATIONS
    </button>
    <div id="blockedHelp" class="blocked-help">
        <strong style="color:var(--danger); display:block; margin-bottom:5px;"> NOTIFICATIONS ARE BLOCKED!</strong>
        1. Click the <b>Lock Icon </b> or <b>Settings Icon</b> beside the URL bar.<br>
        2. Click <b>Permissions</b> or <b>Site Settings</b>.<br>
        3. Find <b>Notifications</b> and set to <b>Allow</b>.<br>
        4. Reload this page.
    </div>
</div>

<div id="splash-screen">
    <div class="splash-logo">RB<span>LIVE</span></div>
    <div class="splash-loader"></div>
</div>

<div id="customToast">
    <i data-lucide="info" class="toast-icon"></i>
    <span class="toast-msg" id="toastMsg">Notification!</span>
</div>

<div id="customConfirmModal">
    <div class="conf-content">
        <i data-lucide="alert-circle" style="width: 40px; height: 40px; color: var(--gold); margin-bottom: 15px;"></i>
        <h3 class="conf-title" id="confTitle">Confirm Action</h3>
        <p class="conf-msg" id="confMsg">Are you sure you want to proceed?</p>
        <div class="conf-actions">
            <button class="btn-conf-no" onclick="closeCustomConfirm()">CANCEL</button>
            <button class="btn-conf-yes" id="confYesBtn">CONFIRM</button>
        </div>
    </div>
</div>

<div id="loginOverlay">
    <div class="login-bg-blob blob-1"></div>
    <div class="login-bg-blob blob-2"></div>
    <div class="login-app-container">
        <div class="app-logo-lg">RB<span>LIVE</span></div>
        <p class="app-tagline">The ultimate live bingo experience.<br>Play, Win, and Redeem Rewards.</p>
        <div class="promo-badge">
            <i data-lucide="gift" style="width:16px"></i> 
            <span>Register now & Get 500 Free RB Coins</span>
        </div>
        <div class="auth-btn-group">
            <button class="btn-main-auth" onclick="login()">
                <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/action/google.svg" alt="Google" style="width:20px">
                Sign in with Google
            </button>
        </div>
    </div>
    <div class="login-footer-legal">
        <div class="legal-text">
            <span> DISCLAIMER: NOT A GAMBLING SITE</span>
            <span style="opacity: 0.6; font-size: 9px;">For entertainment purposes only. No real money betting.</span>
        </div>
    </div>
</div>

<div class="nav">
    <div style="display:flex; align-items:center; gap:10px;">
        <span style="font-weight: 900; font-size: 20px; text-shadow: 0 2px 5px rgba(0,0,0,0.8);">RB <span style="color:var(--accent-glow)">LIVE</span></span>
    </div>
    <div id="userPanel" style="display:none; align-items: center; gap: 10px;">
        <div class="user-stats">
            <div class="icon-btn" onclick="openSearch()">
                <i data-lucide="search" style="width:20px"></i>
            </div>
            <div class="icon-btn" onclick="openMessenger()">
                <i data-lucide="message-circle" style="width:20px"></i>
                <span id="pmBadge" class="notif-badge"></span>
            </div>
            <div class="icon-btn" onclick="openNotifs()">
                <i data-lucide="bell" style="width:20px"></i>
                <span id="notifDot" class="notif-badge"></span>
            </div>
            </div>
        <img id="userImg" onclick="openMenuModal()" src="">
    </div>
</div>

<div class="disclaimer"><div class="marquee-content"> DISCLAIMER: HINDI ITO GAMBLING SITE. For ENTERTAINMENT PURPOSES lamang.</div></div>

<div class="container">
    <div class="ad-container-global">
        <script type="text/javascript">
            atOptions = { 'key' : '9bf585b6ee39cb9b515e2fae1fa958c2', 'format' : 'iframe', 'height' : 50, 'width' : 320, 'params' : {} };
        </script>
        <script type="text/javascript" src="https://pl28660488.effectivegatecpm.com/9b/f5/85/9bf585b6ee39cb9b515e2fae1fa958c2.js"></script>
    </div>

    <div id="view-home" style="display:block;">
        <div id="friendRequestsSection"></div>
        
        <div class="post-creator" id="mainPostCreator">
            <div class="post-creator-top">
                <img id="creatorAvatar" class="post-creator-avatar" src="https://via.placeholder.com/40">
                <textarea id="postInput" class="post-input" placeholder="What's on your mind?"></textarea>
            </div>
            
            <div class="image-preview-container" id="imgPreviewCont">
                <img id="postImgPreview" class="image-preview-img">
                <div class="btn-remove-img" onclick="removePostImage()">X</div>
            </div>

            <div class="post-creator-divider"></div>

            <div class="mood-selector" style="margin-top:5px;">
                <div class="mood-chip" onclick="selectMood(this, 'Happy')"> Happy</div>
                <div class="mood-chip" onclick="selectMood(this, 'Sad')"> Sad</div>
                <div class="mood-chip" onclick="selectMood(this, 'Excited')"> Excited</div>
                <div class="mood-chip" onclick="selectMood(this, 'Angry')"> Angry</div>
                <div class="mood-chip" onclick="selectMood(this, 'Chill')"> Chill</div>
            </div>

            <div class="post-creator-actions">
                <div style="display:flex; gap:5px;">
                    <label for="postImgInput" class="post-tool-btn">
                        <i data-lucide="image" style="width:18px;"></i> Photo
                    </label>
                    <input type="file" id="postImgInput" accept="image/*" style="display:none" onchange="handlePostImage(this)">
                </div>
                <button class="btn-post" onclick="createPost()">POST</button>
            </div>
        </div>

        <div id="pymkSection" class="pymk-section" style="display:none;">
            <div class="pymk-title">People You May Know</div>
            <div class="pymk-scroll" id="pymkList"></div>
        </div>

        <div id="socialFeed" class="social-feed-container">
            <div style="text-align:center; padding:20px; opacity:0.5;">Loading Feed...</div>
        </div>
    </div>

    <div id="view-bingo" style="display:none;">
        <div class="video-feed-wrapper">
            <div class="video-container">
                <div class="video-overlay-bl"><i data-lucide="users" style="width:14px"></i><span id="onlineCount">0</span> ONLINE</div>
                <div id="videoOfflineState" style="display:none; position:absolute; inset:0; background:#0f172a; flex-direction:column; align-items:center; justify-content:center; z-index:20;">
                    <div style="width:60px; height:60px; background:rgba(255,255,255,0.05); border-radius:50%; display:flex; align-items:center; justify-content:center; margin-bottom:15px; animation:pulse-ring 2s infinite;">
                        <i data-lucide="radio" style="width:30px; height:30px; color:#94a3b8;"></i>
                    </div>
                    <h3 style="margin:0; font-size:16px; font-weight:900; color:white; letter-spacing:1px;">WAITING FOR LIVE</h3>
                    <p style="margin:5px 0 0; font-size:12px; color:#64748b;">Stand by for the next draw.</p>
                </div>
                <iframe id="liveVideoFrame" width="100%" height="100%" src="https://www.youtube.com/embed/4I_NSJTbdXo?autoplay=1&mute=1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen style="border:none; position:absolute; top:0; left:0; width:100%; height:100%;"></iframe>
            </div>
        </div>

        <div id="jackpotBanner">
            <div class="jp-label-new">
                <i data-lucide="crown" style="width: 16px;"></i> JACKPOT ROUND <i data-lucide="crown" style="width: 16px;"></i>
            </div>
            <span class="jackpot-amount" id="jackpotDisplayVal">5,000</span>
            <div style="font-size: 10px; opacity: 0.7; margin-top: 5px; color: #fbbf24;">RB COINS GRAND PRIZE</div>
        </div>

        <div id="nextDrawBanner" class="next-draw-container">
            <div class="nd-icon"><i data-lucide="calendar-days"></i></div>
            <div class="nd-info">
                <div class="next-draw-label">Susunod na Bola</div>
                <div id="nextDrawTime" class="next-draw-time">--:-- --</div>
            </div>
        </div>
        
        <div id="winnerBanner">
            <span><i data-lucide="party-popper" style="width:24px; height:24px;"></i> BINGO WINNER!</span>
            <span class="winner-line" id="winnerPatternLine">Pattern: Normal Bingo</span>
        </div>

        <div class="draw-panel">
            <div class="prev-balls" id="ballRow"></div>
            <div class="current-ball-box"><span style="font-size:9px; font-weight:800; opacity:0.8; color:white;">NOW DRAWN</span><span id="currentBall" style="font-size:36px; font-weight:900; color:white; text-shadow:0 2px 10px rgba(0,0,0,0.5);">--</span></div>
        </div>
        
        <div class="card" id="bingoCardContainer">
            <div id="lateOverlay" class="late-overlay">
                <i data-lucide="lock" style="color:var(--danger); width:48px; height:48px; margin-bottom:15px; filter: drop-shadow(0 0 10px var(--danger));"></i>
                <div class="late-text">GAME ONGOING</div>
                <div class="late-subtext">Sorry, ongoing na ang bola. Bawal na sumali ang late.</div>
                <div style="margin-top:20px; background:rgba(255,255,255,0.1); padding:10px 20px; border-radius:12px; border:1px solid rgba(255,255,255,0.1);">
                    <span style="font-size:10px; display:block; opacity:0.7;">NEXT GAME:</span>
                    <strong id="lateNextSched" style="font-size:16px; color:var(--gold);">--:--</strong>
                </div>
            </div>
            <div id="gameOverOverlay" class="game-over-overlay">
                <i data-lucide="trophy" style="color:var(--gold); width:50px; height:50px; margin-bottom:15px; filter: drop-shadow(0 0 15px var(--gold));"></i>
                <div class="late-text">Game Finished</div>
                <div class="late-subtext" id="gameOverMsg">Better luck next time!</div>
            </div>
            <div class="change-card-wrapper" style="display:flex; justify-content:space-between; align-items:center; padding-bottom:15px;">
                <div class="pattern-box">
                    <div class="pattern-dot"></div>
                    <span class="pattern-text" id="patternName">Normal Bingo</span>
                </div>
                <button class="btn-change" id="newCardBtn" onclick="generateNewCard()"><i data-lucide="refresh-cw" style="width:14px"></i> NEW CARD</button>
            </div>
            <div class="bingo-header"><div class="letter">B</div><div class="letter">I</div><div class="letter">N</div><div class="letter">G</div><div class="letter">O</div></div>
            <div class="grid" id="bingoGrid"></div>
        </div>
        
        <div class="chat-box" style="margin-top:15px;">
            <div class="chat-header">
                <i data-lucide="message-square" style="width:18px; color:var(--accent-glow)"></i>
                <h3>LIVE STREAM CHAT</h3>
            </div>
            <div id="chatList"></div>
            <div id="replyIndicator" class="reply-indicator" style="display:none; padding: 5px 15px; background: #374151; color: #d1d5db; font-size: 11px;">
                <span id="replyText">Replying to...</span>
                <button onclick="cancelReply()" style="background:none; border:none; color:white; cursor:pointer;"><i data-lucide="x" style="width:14px"></i></button>
            </div>
            <div class="chat-input-area">
                <form class="input-wrapper" onsubmit="event.preventDefault(); sendChat();">
                    <input type="text" id="chatIn" placeholder="Say something..." autocomplete="off">
                    <button type="submit" class="send-btn">
                        <i data-lucide="send" style="width:16px"></i>
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<div id="grandJackpotModal" onclick="this.style.display='none'">
    <div class="jackpot-rays"></div>
    <div class="jackpot-content">
        <div class="icon-glow"><i data-lucide="crown" style="width: 80px; height: 80px;"></i></div>
        <h1 class="jp-title">JACKPOT WIN!</h1>
        <h2 class="jp-amount" id="grandPrizeAmount">10,000 RB COINS</h2>
        <div class="jp-name" id="jpWinnerName">WINNER NAME</div>
        <p style="font-size: 11px; color: white; opacity: 0.7; margin-top: 20px;">Tap anywhere to close</p>
    </div>
</div>

<div id="pmModal" class="pm-modal">
    <div class="pm-container">
        <div id="pmInboxView" style="display:flex; flex-direction:column; height:100%;">
            <div class="pm-header">
                <h3>Chats</h3>
                <button onclick="document.getElementById('pmModal').style.display='none'" style="background:rgba(255,255,255,0.1); border:none; width:30px; height:30px; border-radius:50%; color:white; display:flex; align-items:center; justify-content:center;"><i data-lucide="x" style="width:16px;"></i></button>
            </div>
            <div class="active-friends-bar" id="activeFriendsBar">
                </div>
            <div id="pmList" class="pm-inbox-list"></div>
        </div>
        <div id="pmChatView" class="pm-chat-view">
            <div class="pm-chat-header">
                <button onclick="backToInbox()" style="background:none; border:none; color:var(--messenger-blue);"><i data-lucide="arrow-left"></i></button>
                <div style="display:flex; align-items:center;">
                     <img id="chatTargetImg" style="width:36px; height:36px; border-radius:50%; margin-left:5px;">
                     <div style="display:flex; flex-direction:column; margin-left:10px;">
                        <span id="chatTargetName" style="font-weight:700; font-size:15px; color:white;">User</span>
                        <span style="font-size:11px; color:#b0b3b8;">Active now</span>
                     </div>
                </div>
                <button onclick="showToast('Calling feature coming soon!')" style="background:rgba(0,0,0,0.2); border:none; width:36px; height:36px; border-radius:50%; color:var(--success); display:flex; align-items:center; justify-content:center; margin-left:auto;"><i data-lucide="phone" style="width:18px"></i></button>
            </div>
            <div id="pmMessages" class="pm-messages"></div>
            <form class="pm-input-area" onsubmit="event.preventDefault(); sendPrivateMessage();">
                <button type="button" style="background:none; border:none; color:var(--messenger-blue); margin-right:5px;" onclick="document.getElementById('pmImgInput').click()">
                    <i data-lucide="image" style="width:24px"></i>
                </button>
                <input type="file" id="pmImgInput" accept="image/*" style="display:none" onchange="handlePMImage(this)">
                
                <input type="text" id="pmInput" class="pm-styled-input" placeholder="Type a message..." autocomplete="off">
                <button type="submit" style="background:none; border:none; color:var(--messenger-blue); cursor:pointer;">
                    <i data-lucide="send" style="width:24px"></i>
                </button>
                <button type="button" style="background:none; border:none; color:var(--messenger-blue); margin-left:5px;" onclick="sendPMLike()">
                    <i data-lucide="thumbs-up" style="width:24px"></i>
                </button>
            </form>
        </div>
    </div>
</div>

<div id="notifModal" class="modal" onclick="this.style.display='none'">
    <div class="modal-content" onclick="event.stopPropagation()">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:15px;">
            <div style="display:flex; align-items:center; gap:10px;">
                <div style="background:rgba(255,255,255,0.1); padding:8px; border-radius:10px;"><i data-lucide="bell" style="width:20px;"></i></div>
                <h3 style="margin:0; font-size:18px;">Notifications</h3>
            </div>
            <button onclick="document.getElementById('notifModal').style.display='none'" style="background:none; border:none; color:white;"><i data-lucide="x"></i></button>
        </div>
        <div id="notifList"></div>
    </div>
</div>

<div id="userOptionsModal" class="modal" onclick="this.style.display='none'">
    <div class="modal-content" onclick="event.stopPropagation()" style="text-align:center;">
        <img id="optUserImg" style="width:60px; height:60px; border-radius:50%; border:2px solid var(--accent); margin-bottom:10px;">
        <h3 id="optUserName" style="margin:0 0 20px 0; color:white;">User</h3>
        
        <button class="user-opt-btn" onclick="openUserProfile(targetUserForOpt.uid)"><i data-lucide="user"></i> View Profile</button>
        <button class="user-opt-btn" onclick="optAddFriend()"><i data-lucide="user-plus"></i> Add Friend</button>
        <button class="user-opt-btn" onclick="optSendMessage()"><i data-lucide="message-circle"></i> Send Message</button>
        <button class="user-opt-btn" onclick="document.getElementById('userOptionsModal').style.display='none'"><i data-lucide="x"></i> Close</button>
    </div>
</div>

<div id="commentModalBackdrop" class="comment-modal-backdrop" onclick="closeComments()"></div>
<div id="commentModal" class="comment-modal">
    <div class="comment-header">
        <h3 style="margin:0; font-size:16px;">Comments</h3>
        <button onclick="closeComments()" style="background:none; border:none; color:white;"><i data-lucide="x"></i></button>
    </div>
    <div id="commentList" class="comment-list"></div>
    <form class="comment-input-area" onsubmit="event.preventDefault(); sendComment();">
        <input type="text" id="commentInput" class="comment-input" placeholder="Write a comment..." autocomplete="off">
        <button type="submit" style="background:none; border:none; color:var(--accent);"><i data-lucide="send"></i></button>
    </form>
</div>

<div id="searchModal" class="search-modal-container">
    <div class="search-header">
        <button onclick="document.getElementById('searchModal').style.display='none'" style="background:none; border:none; color:white;"><i data-lucide="arrow-left"></i></button>
        <div class="search-bar-wrap">
            <i data-lucide="search" style="width:16px; opacity:0.5;"></i>
            <input type="text" id="searchInput" class="search-input" placeholder="Search users or posts..." onkeyup="handleSearch()">
        </div>
    </div>
    <div id="searchResults" class="search-results">
        <div style="text-align:center; opacity:0.5; padding:20px;">Type to search...</div>
    </div>
</div>

<div id="userProfilePage" class="profile-page-container">
    <button class="profile-nav-back" onclick="closeProfilePage()">
        <i data-lucide="arrow-left"></i>
    </button>
    <div class="profile-cover" id="pageProfileCover"></div>
    
    <div class="profile-info-section">
        <div class="profile-header-row">
            <img id="pageProfileImg" class="profile-page-img" src="">
             <div style="padding-bottom: 15px;">
                 <h2 id="pageProfileName" class="profile-page-name">User Name</h2>
                 <button id="profileMainActionBtn" class="profile-action-btn" onclick="handleProfileMainAction()">Add Friend</button>
             </div>
        </div>
        
        <p id="pageProfileBio" class="profile-page-bio">Radio Bingo Player</p>
        
        <div class="profile-stats">
            <div class="stat-item">
                <div class="stat-val" id="statFriends">0</div>
                <div class="stat-lbl">Friends</div>
            </div>
            <div class="stat-item">
                <div class="stat-val" id="statLikes">0</div>
                <div class="stat-lbl">Likes</div>
            </div>
             <div class="stat-item">
                <div class="stat-val" id="statPosts">0</div>
                <div class="stat-lbl">Posts</div>
            </div>
        </div>
        
        <div id="pageProfileFeed" class="profile-feed-section"></div>
    </div>
</div>

<div id="editProfileModal" class="modal" onclick="this.style.display='none'">
    <div class="modal-content" onclick="event.stopPropagation()">
        <h3 style="margin-top:0; color:white;">Edit Profile</h3>
        
        <label class="edit-label">Display Name</label>
        <input type="text" id="editNameIn" class="edit-input" placeholder="Your Name">
        
        <label class="edit-label">Bio</label>
        <input type="text" id="editBioIn" class="edit-input" placeholder="Short bio...">
        
        <label class="edit-label">Change Profile Picture</label>
        <input type="file" id="editProfilePicInput" class="edit-input" accept="image/*" onchange="handleProfileUpload(this, 'pfp')">
        
        <label class="edit-label">Change Cover Photo</label>
        <input type="file" id="editCoverPicInput" class="edit-input" accept="image/*" onchange="handleProfileUpload(this, 'cover')">

        <button onclick="saveProfileChanges()" style="width:100%; padding:15px; background:var(--accent); border:none; border-radius:12px; font-weight:900; color:white; cursor:pointer;">SAVE CHANGES</button>
    </div>
</div>

<div id="installGuideModal" class="modal" onclick="this.style.display='none'">
    <div class="modal-content" onclick="event.stopPropagation()">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
            <h3 style="margin:0; font-size:18px; font-weight:900;">INSTALL GUIDE</h3>
            <button onclick="document.getElementById('installGuideModal').style.display='none'" style="background:none; border:none; color:white;"><i data-lucide="x"></i></button>
        </div>
        <div class="install-tabs">
            <button class="install-tab-btn active" id="tabAndroid" onclick="showGuide('android')">ANDROID</button>
            <button class="install-tab-btn" id="tabIOS" onclick="showGuide('ios')">iOS</button>
        </div>
        <div id="guideAndroidContent">
            <div class="guide-step"><div class="step-num">1</div><div class="step-text">Pindutin ang <b>Three Dots ()</b> sa upper right corner ng Google Chrome browser.</div></div>
            <div class="guide-step"><div class="step-num">2</div><div class="step-text">Hanapin at pindutin ang <b>"Install App"</b> o <b>"Add to Home Screen"</b>.</div></div>
            <div class="guide-step"><div class="step-num">3</div><div class="step-text">Click <b>Install</b> para mapunta ito sa iyong home screen.</div></div>
        </div>
        <div id="guideIOSContent" style="display:none;">
            <div class="guide-step"><div class="step-num">1</div><div class="step-text">Gamitin ang <b>Safari Browser</b> at pindutin ang <b>Share Icon</b> <i data-lucide="share" style="width:12px"></i> sa ibaba.</div></div>
            <div class="guide-step"><div class="step-num">2</div><div class="step-text">Mag-scroll pababa at hanapin ang <b>"Add to Home Screen"</b> <i data-lucide="plus-square" style="width:12px"></i>.</div></div>
            <div class="guide-step"><div class="step-num">3</div><div class="step-text">Click <b>Add</b> sa upper right corner.</div></div>
        </div>
    </div>
</div>

<div id="menuModal" class="modal" onclick="this.style.display='none'">
    <div class="modal-content" onclick="event.stopPropagation()">
        <div class="profile-header">
            <img id="profileImgLarge" class="profile-img-large" src="">
            <div class="profile-name-info">
                <h2 class="profile-name" id="profileNameDisplay">User Name</h2>
                <span class="profile-uid" id="profileUidDisplay">UID: ---</span>
            </div>
            <button onclick="document.getElementById('menuModal').style.display='none'" style="background:none; border:none; color:white; opacity:0.5;"><i data-lucide="x"></i></button>
        </div>
        <div class="gcash-section">
            <span style="font-size:10px; font-weight:800; color:var(--accent-glow); text-transform:uppercase; margin-bottom:10px; display:flex; align-items:center; gap:5px;"><i data-lucide="credit-card" style="width:12px"></i> Email / Redemption Info</span>
            <div style="display:flex; gap:10px;">
                <input type="text" id="gcashInput" class="styled-input" placeholder="Enter email or details">
                <button onclick="saveGcash(); playSound('click');" style="background:var(--accent); border:none; color:white; padding:0 20px; border-radius:12px; font-weight:800; font-size:12px; cursor:pointer; box-shadow:0 4px 10px rgba(59, 130, 246, 0.3);">SAVE</button>
            </div>
        </div>
        <div class="ref-container">
            <span style="font-size:10px; font-weight:800; color:var(--success); text-transform:uppercase; margin-bottom:10px; display:flex; align-items:center; gap:5px;"><i data-lucide="share-2" style="width:12px"></i> Invite & Earn</span>
            <input type="text" id="refLink" readonly class="styled-input" style="background:rgba(0,0,0,0.2); text-align:center; cursor:pointer; margin-bottom:10px;" onclick="this.select(); document.execCommand('copy'); showToast('Copied Link!'); playSound('click');">
            <div id="referralInputSection">
                <span style="font-size:10px; font-weight:800; color:var(--gold); text-transform:uppercase; margin-bottom:10px; display:flex; align-items:center; gap:5px; margin-top:15px;"><i data-lucide="ticket" style="width:12px"></i> Claim Referral Code</span>
                <div style="display:flex; gap:10px;">
                    <input type="text" id="referralInput" class="styled-input" placeholder="ENTER CODE">
                    <button onclick="claimReferral(); playSound('click');" style="background:var(--gold); border:none; color:black; padding:0 20px; border-radius:12px; font-weight:800; font-size:12px; cursor:pointer; box-shadow:0 4px 10px rgba(251, 191, 36, 0.3);">CLAIM</button>
                </div>
            </div>
        </div>
        <div class="history-box">
            <span style="font-size:10px; font-weight:800; color:white; text-transform:uppercase; margin-bottom:10px; display:flex; align-items:center; gap:5px;"><i data-lucide="history" style="width:12px"></i> Transaction History</span>
            <div id="historyList" class="history-list"></div>
        </div>
        <button onclick="auth.signOut().then(()=>location.reload())" style="width:100%; padding:14px; background:rgba(239, 68, 68, 0.1); color:var(--danger); border:1px solid rgba(239, 68, 68, 0.2); border-radius:14px; font-weight:800; margin-top:20px; cursor:pointer; display:flex; align-items:center; justify-content:center; gap:8px;">
            <i data-lucide="log-out" style="width:18px"></i> Sign Out
        </button>
    </div>
</div>
<div id="storeModal" class="modal" onclick="this.style.display='none'">
    <div class="modal-content" onclick="event.stopPropagation()">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px; border-bottom: 1px solid rgba(255,255,255,0.05); padding-bottom: 15px;">
            <div>
                <h3 style="margin:0; font-size: 20px; font-weight: 900;">MARKETPLACE</h3>
                <p style="margin: 5px 0 0 0; font-size: 11px; opacity: 0.8; font-weight: 600;">Redeem, Shop Skins, or Earn</p>
            </div>
            <div class="points-badge" style="height:35px; border-radius: 10px;"><i data-lucide="coins" style="width:14px"></i> <span id="storePoints">0</span></div>
        </div>
        <div class="store-nav">
            <button class="store-tab-btn active" onclick="switchStoreTab('cashout')" id="tabBtnCash">Cash Out</button>
            <button class="store-tab-btn" onclick="switchStoreTab('skins')" id="tabBtnSkins">Skins</button>
            <button class="store-tab-btn" onclick="switchStoreTab('earn')" id="tabBtnEarn" style="color:var(--gold);">Tasks</button>
        </div>
        
        <div class="glass-panel" style="padding: 15px; border-radius: 18px; margin-bottom: 20px; border: 1px dashed var(--gold); text-align: center; position: relative; overflow: hidden;">
            <h4 style="margin: 0 0 10px 0; color: var(--gold); font-size: 14px; text-transform: uppercase;"> FREE RB COINS </h4>
            <div id="adTimerOverlay" style="display: none; position: absolute; inset: 0; background: rgba(15, 23, 42, 0.98); z-index: 50; align-items: center; justify-content: center; flex-direction: column;">
                <div id="adStatusIcon" style="font-size: 30px; margin-bottom: 10px;"></div>
                <div style="font-size: 18px; font-weight: 900; color: white;" id="adCountdown">30s</div>
                <div style="font-size: 12px; color: #ef4444; padding: 0 20px; margin-top: 5px; font-weight:800;" id="adStatusText">Do not close app or switch tabs!</div>
            </div>
            <div id="adCaptchaOverlay" style="display: none; position: absolute; inset: 0; background: rgba(15, 23, 42, 0.98); z-index: 51; align-items: center; justify-content: center; flex-direction: column;">
                <div style="font-size: 14px; font-weight: 700; color: var(--accent-glow); margin-bottom: 10px;">HUMAN VERIFICATION</div>
                <div style="background: rgba(255,255,255,0.1); padding: 10px; border-radius: 12px; margin-bottom: 10px;">
                    <span id="mathQ" style="font-size: 20px; font-weight: 900; color: white;">5 + 3 = ?</span>
                </div>
                <div style="display: flex; gap: 5px;">
                    <input type="number" id="mathAns" style="width: 60px; padding: 8px; border-radius: 8px; border: 1px solid var(--accent); background: #0f172a; color: white; text-align: center; font-weight: 800;">
                    <button onclick="verifyAdMath()" style="background: var(--success); border: none; padding: 8px 12px; border-radius: 8px; color: white; font-weight: 900;">OK</button>
                </div>
            </div>
            <button id="btnWatchAd" onclick="startStrictWatch()" style="background: linear-gradient(135deg, #f59e0b, #b45309); width: 100%; border: none; padding: 15px; border-radius: 12px; font-weight: 900; color: white; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 14px; box-shadow: 0 5px 15px rgba(245, 158, 11, 0.4); text-shadow: 0 1px 2px black;">
                <i data-lucide="play-circle" style="width: 20px;"></i> WATCH AD (+50 Coins)
            </button>
            <p style="font-size: 10px; opacity: 0.6; margin-top: 8px; color:var(--danger);">*Timer pauses if you leave the app!</p>
        </div>

        <div id="storeSection-cashout" style="display:block;">
            <div class="reward-grid">
                <div class="reward-item">
                    <div class="reward-main"><div class="reward-icon-box"><i data-lucide="gift" style="width:22px"></i></div><div class="reward-info"><b>20 Gift Card</b><small><i data-lucide="database" style="width:10px"></i> 50,000 Coins</small></div></div>
                    <button class="btn-redeem" onclick="redeemItem('20 Gift Card', 50000)">Redeem</button>
                </div>
                <div class="reward-item">
                    <div class="reward-main"><div class="reward-icon-box" style="color:var(--gold); background:rgba(251, 191, 36, 0.1); border-color:rgba(251, 191, 36, 0.3);"><i data-lucide="gift" style="width:22px"></i></div><div class="reward-info"><b>50 Gift Card</b><small><i data-lucide="database" style="width:10px"></i> 125,000 Coins</small></div></div>
                    <button class="btn-redeem" onclick="redeemItem('50 Gift Card', 125000)">Redeem</button>
                </div>
                <div class="reward-item">
                    <div class="reward-main"><div class="reward-icon-box" style="color:var(--success); background:rgba(16, 185, 129, 0.1); border-color:rgba(16, 185, 129, 0.3);"><i data-lucide="gift" style="width:22px"></i></div><div class="reward-info"><b>100 Gift Card</b><small><i data-lucide="database" style="width:10px"></i> 250,000 Coins</small></div></div>
                    <button class="btn-redeem" onclick="redeemItem('100 Gift Card', 250000)">Redeem</button>
                </div>
            </div>
            <p style="text-align: center; font-size: 10px; opacity: 0.6; margin-top: 25px; line-height: 1.5; text-shadow:0 1px 2px black;">*Processing may take 24-48 hours.<br>Make sure your redemption details are correct.</p>
        </div>

        <div id="storeSection-skins" style="display:none;">
            <p style="font-size:11px; opacity:0.7; margin-bottom:15px; text-align:center;">Customize your Bingo Card. Look rich, play rich.</p>
            
            <div style="margin-bottom:20px; padding:15px; background:rgba(255,255,255,0.05); border-radius:12px; text-align:center;">
                <label style="font-size:12px; font-weight:700; display:block; margin-bottom:10px; color:var(--accent-glow);">UPLOAD CUSTOM BACKGROUND</label>
                <input type="file" accept="image/*" id="customSkinInput" style="display:none" onchange="handleCustomSkinUpload(this)">
                <button onclick="document.getElementById('customSkinInput').click()" style="background:var(--accent); color:white; border:none; padding:8px 15px; border-radius:8px; font-weight:800; font-size:11px; cursor:pointer;">CHOOSE IMAGE</button>
            </div>

            <div class="skins-grid">
                <div class="skin-item"><div class="skin-preview" style="background:rgba(30,41,59,0.8); border:1px solid rgba(255,255,255,0.1);">B</div><div class="skin-name">Classic</div><div class="skin-cost">Free</div><button class="btn-buy-skin equip" id="btn-skin-default" onclick="equipSkin('default')">EQUIP</button></div>
                <div class="skin-item"><div class="skin-preview" style="background:rgba(8,51,68,1); border:2px solid #06b6d4; color:#67e8f9; text-shadow:0 0 5px #06b6d4;">B</div><div class="skin-name">Neon City</div><div class="skin-cost">50,000 Coins</div><button class="btn-buy-skin buy" id="btn-skin-neon" onclick="buyOrEquipSkin('neon', 50000)">BUY</button></div>
                <div class="skin-item"><div class="skin-preview" style="background:linear-gradient(135deg, #451a03, #000); border:2px solid #f59e0b; color:#fcd34d; font-family:'Times New Roman',serif;">B</div><div class="skin-name">Luxury Gold</div><div class="skin-cost">100,000 Coins</div><button class="btn-buy-skin buy" id="btn-skin-gold" onclick="buyOrEquipSkin('gold', 100000)">BUY</button></div>
                <div class="skin-item"><div class="skin-preview" style="background:rgba(80, 7, 36, 1); border:2px solid #ec4899; color:#fbcfe8; border-radius:50%;">B</div><div class="skin-name">Kawaii Pink</div><div class="skin-cost">25,000 Coins</div><button class="btn-buy-skin buy" id="btn-skin-pink" onclick="buyOrEquipSkin('pink', 25000)">BUY</button></div>
                
                <div class="skin-item"><div class="skin-preview" style="background:pink; border:2px solid hotpink; color:deeppink; font-family:'Comic Neue',cursive;">B</div><div class="skin-name">Hello Kitty</div><div class="skin-cost">75,000 Coins</div><button class="btn-buy-skin buy" id="btn-skin-kitty" onclick="buyOrEquipSkin('kitty', 75000)">BUY</button></div>
                <div class="skin-item"><div class="skin-preview" style="background:#0096df; border:2px solid white; color:white; border-radius:50%;">B</div><div class="skin-name">Doraemon</div><div class="skin-cost">75,000 Coins</div><button class="btn-buy-skin buy" id="btn-skin-doraemon" onclick="buyOrEquipSkin('doraemon', 75000)">BUY</button></div>
                <div class="skin-item"><div class="skin-preview" style="background:#f7f44d; border:2px dashed brown; color:brown;">B</div><div class="skin-name">SpongeBob</div><div class="skin-cost">75,000 Coins</div><button class="btn-buy-skin buy" id="btn-skin-spongebob" onclick="buyOrEquipSkin('spongebob', 75000)">BUY</button></div>
                <div class="skin-item"><div class="skin-preview" style="background:black; border:2px solid purple; color:pink;">B</div><div class="skin-name">Kuromi</div><div class="skin-cost">75,000 Coins</div><button class="btn-buy-skin buy" id="btn-skin-kuromi" onclick="buyOrEquipSkin('kuromi', 75000)">BUY</button></div>

                <div class="skin-item" id="customSkinSlot" style="display:none;"><div class="skin-preview" id="customSkinPreview" style="background-size:cover;">B</div><div class="skin-name">My Custom</div><div class="skin-cost">Owned</div><button class="btn-buy-skin equip" id="btn-skin-custom" onclick="equipSkin('custom')">EQUIP</button></div>
            </div>
        </div>
        
        <div id="storeSection-earn" style="display:none;">
            <p style="font-size:11px; opacity:0.7; margin-bottom:15px; text-align:center;">Complete tasks to earn huge coins instantly.</p>
            <div class="task-list">
                <div class="task-item" style="border-color: #ef4444; background: linear-gradient(90deg, rgba(69,10,10,0.8), rgba(15,23,42,0.8));">
                    <div class="task-info"><h4 style="color:#fca5a5;">Watch Video Task</h4><p>Watch full video to unlock reward</p><span class="task-reward" style="background: rgba(239,68,68,0.2); border-color:#ef4444; color:#fca5a5;">+2,000 Coins</span></div>
                    <button class="btn-do-task" style="background:#ef4444;" id="btn-task-video" onclick="openVideoLocker('video')">WATCH</button>
                </div>
                <div class="task-item">
                    <div class="task-info"><h4>Premium Offer</h4><p>Complete simple offer to verify</p><span class="task-reward">+5,000 Coins</span></div>
                    <button class="btn-do-task" id="btn-task-premium" onclick="startTaskSafe('https://doctoredits.com/1874673', 5000, 'premium')">GO</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="pwaInstallBanner">
    <div><span class="pwa-text">INSTALL APP</span><span class="pwa-sub">Download for better experience!</span></div>
    <button id="pwaBottomBtn" class="pwa-btn">INSTALL</button>
</div>

<div id="newProfileModal" class="rb-profile-modal">
    <div class="rb-profile-content">
        
        <div class="rb-cover-area">
            <div class="rb-cover-overlay"></div>
            <div class="rb-nav-top">
                <button class="rb-btn-icon" onclick="document.getElementById('newProfileModal').style.display='none'">
                    <i data-lucide="arrow-left" style="width:20px"></i>
                </button>
                <button class="rb-btn-icon" onclick="openEditProfile()"> 
                    <i data-lucide="settings" style="width:20px"></i>
                </button>
            </div>
        </div>

        <div class="rb-user-card">
            <div class="rb-avatar-wrap">
                <img id="newProfileImg" class="rb-avatar-img" src="">
                <div class="rb-vip-badge">
                    <i data-lucide="crown" style="width:14px; color:black;"></i>
                </div>
            </div>

            <div class="rb-name" id="newProfileName">User Name</div>
            <div class="rb-uid" id="newProfileUid">UID: ---</div>
            
            <div class="rb-bio" id="newProfileBio">...</div>

            <div class="rb-stats-row">
                <div class="rb-stat-box">
                    <span class="rb-stat-num" id="newStatPoints" style="color:var(--gold)">0</span>
                    <span class="rb-stat-label">Coins</span>
                </div>
                <div class="rb-stat-box">
                    <span class="rb-stat-num" id="newStatWins" style="color:var(--accent-glow)">0</span>
                    <span class="rb-stat-label">Wins</span>
                </div>
                <div class="rb-stat-box">
                    <span class="rb-stat-num" id="newStatFriends">0</span>
                    <span class="rb-stat-label">Friends</span>
                </div>
            </div>

            <div class="rb-actions">
                <button class="rb-btn-primary" id="newProfileMainBtn">
                    <i data-lucide="user-plus" style="width:16px"></i> Add Friend
                </button>
                <button class="rb-btn-secondary" onclick="optSendMessage()">
                    <i data-lucide="message-circle" style="width:16px"></i> Chat
                </button>
            </div>
        </div>

        <div class="rb-tabs-container">
            <div class="rb-tabs-header">
                <div class="rb-tab-item active">ACTIVITY</div>
                <div class="rb-tab-item">SKINS</div>
            </div>

            <div id="newProfileFeed" style="display:flex; flex-direction:column; gap:10px;">
                <div style="text-align:center; padding:20px; color:#64748b; font-size:12px;">
                    Loading activity...
                </div>
            </div>
        </div>

    </div>
</div>
<script>
/* === PART 3: MODERN PROFILE LOGIC OVERRIDE === */
/* PASTE MO ITO SA PINAKA-BABA BAGO MAG </body> */

// 1. OVERWRITE openUserProfile para buksan ang BAGONG MODAL
window.openUserProfile = function(uid) {
    currentProfileUid = uid;
    
    // Hide Old Modals (Siguradong nakatago ang luma)
    document.getElementById('userOptionsModal').style.display = 'none';
    if(document.getElementById('userProfilePage')) document.getElementById('userProfilePage').style.display = 'none';
    
    // Show NEW Glass Modal
    const modal = document.getElementById('newProfileModal');
    modal.style.display = 'block';
    
    // Set Loading State
    document.getElementById('newProfileName').innerText = "Loading...";
    document.getElementById('newProfileFeed').innerHTML = "<div style='text-align:center; padding:30px; color:#94a3b8; font-size:12px;'>Fetching data...</div>";
    
    // Fetch User Data from Firebase
    db.ref('users/' + uid).once('value', s => {
        const u = s.val() || {};
        
        // Populate Identity
        document.getElementById('newProfileImg').src = u.photo || 'https://via.placeholder.com/100';
        
        // Gamitin ang existing getBadgeHtml function kung meron, kung wala gumawa ng fallback
        let badge = "";
        if(typeof getBadgeHtml === "function") {
            badge = getBadgeHtml(u.points || 0);
        }
        document.getElementById('newProfileName').innerHTML = `${u.name} ${badge}`;
        document.getElementById('newProfileUid').innerText = "UID: " + uid.substring(0,8).toUpperCase();
        document.getElementById('newProfileBio').innerText = u.bio || "Radio Bingo Player";
        
        // Populate Stats
        document.getElementById('newStatPoints').innerText = (u.points || 0).toLocaleString();
        
        // Count Friends
        db.ref('friends/' + uid).once('value', fSnap => {
            document.getElementById('newStatFriends').innerText = fSnap.numChildren() || 0;
        });

        // Wins (Fallback to 0 if no record)
        document.getElementById('newStatWins').innerText = u.wins || 0; 

        // Update Buttons (Edit vs Add Friend logic)
        updateNewProfileButton(uid);

        // Load Posts sa BAGONG Feed Container
        loadProfilePostsNew(uid);
        
        // Refresh Icons
        if(typeof lucide !== 'undefined') lucide.createIcons();
    });
};

// 2. LOGIC PARA SA BUTTONS (Edit o Add Friend)
function updateNewProfileButton(uid) {
    const btn = document.getElementById('newProfileMainBtn');
    if(!auth.currentUser) return;
    const myUid = auth.currentUser.uid;

    if(uid === myUid) {
        // Self View -> Edit Profile
        btn.innerHTML = `<i data-lucide="settings" style="width:16px"></i> Edit Profile`;
        btn.className = "rb-btn-secondary"; 
        btn.onclick = openEditProfile; // Reuse existing edit function
    } else {
        // Other User View -> Check Friendship
        db.ref('friends/' + myUid + '/' + uid).once('value', s => {
            if(s.exists()) {
                btn.innerHTML = `<i data-lucide="check" style="width:16px"></i> Friends`;
                btn.className = "rb-btn-secondary";
                btn.onclick = null;
            } else {
                db.ref('friendRequests/' + uid + '/' + myUid).once('value', reqSnap => {
                    if(reqSnap.exists()) {
                        btn.innerHTML = `<i data-lucide="clock" style="width:16px"></i> Request Sent`;
                        btn.className = "rb-btn-secondary";
                        btn.onclick = null;
                    } else {
                        btn.innerHTML = `<i data-lucide="user-plus" style="width:16px"></i> Add Friend`;
                        btn.className = "rb-btn-primary"; 
                        btn.onclick = () => {
                            db.ref('friendRequests/' + uid + '/' + myUid).set(true);
                            updateNewProfileButton(uid);
                            showToast("Friend Request Sent!");
                            playSound('click');
                        };
                    }
                });
            }
        });
    }
    setTimeout(() => { if(typeof lucide !== 'undefined') lucide.createIcons(); }, 100);
}

// 3. POST LOADER PARA SA BAGONG DESIGN
function loadProfilePostsNew(uid) {
    const container = document.getElementById('newProfileFeed');
    
    db.ref('socialPosts').orderByChild('uid').equalTo(uid).limitToLast(20).once('value', pSnap => {
        container.innerHTML = "";
        const posts = [];
        pSnap.forEach(c => { posts.push({ key: c.key, ...c.val() }); });
        
        if(posts.length === 0) {
            container.innerHTML = "<div style='text-align:center; padding:30px; opacity:0.5; font-size:12px;'>No recent posts.</div>";
            return;
        }

        posts.reverse().forEach(post => {
            const div = document.createElement('div');
            div.className = 'post-card'; 
            // Slight adjustment for profile look transparency
            div.style.background = "rgba(255,255,255,0.03)"; 
            div.style.border = "1px solid rgba(255,255,255,0.05)";
            
            const imgHtml = post.image ? `<div class="post-image-container" style="max-height:200px; background:transparent;"><img src="${post.image}" class="post-image" style="max-height:200px;"></div>` : '';
            
            // Reuse existing helper functions like fixDate
            div.innerHTML = `
                <div class="post-header" style="padding:10px; border-bottom:1px solid rgba(255,255,255,0.05);">
                    <div class="post-meta">
                        <div class="post-time" style="color:#64748b; font-size:10px;">${typeof fixDate === 'function' ? fixDate(post.timestamp) : 'Just now'}</div>
                    </div>
                </div>
                <div class="post-content" style="padding:10px 15px;">${post.content}</div>
                ${imgHtml}
                <div class="post-actions" style="border-top:1px solid rgba(255,255,255,0.05);">
                     <button class="action-btn" onclick="toggleReactPopup('${post.key}')">
                        <i data-lucide="thumbs-up" style="width:14px;"></i> React
                    </button>
                    <button class="action-btn" onclick="openComments('${post.key}')">
                        <i data-lucide="message-circle" style="width:14px"></i> Comment
                    </button>
                    <div class="reaction-popup" id="react-popup-${post.key}">
                        <span class="reaction-icon" onclick="reactToPost('${post.key}','${post.uid}','Like')"></span>
                        <span class="reaction-icon" onclick="reactToPost('${post.key}','${post.uid}','Love')"></span>
                        <span class="reaction-icon" onclick="reactToPost('${post.key}','${post.uid}','Haha')"></span>
                    </div>
                </div>
            `;
            container.appendChild(div);
        });
        if(typeof lucide !== 'undefined') lucide.createIcons();
    });
}

// 4. OVERWRITE CLOSE FUNCTION
window.closeProfilePage = function() {
    document.getElementById('newProfileModal').style.display = 'none';
    currentProfileUid = null;
}

// 5. TAB SWITCHING LOGIC (Activity vs Inventory)
// Wait for DOM to be ready before attaching listeners
setTimeout(() => {
    const tabs = document.querySelectorAll('.rb-tab-item');
    if(tabs) {
        tabs.forEach(tab => {
            tab.addEventListener('click', function() {
                // Reset active class
                if(this.parentElement) {
                    this.parentElement.querySelectorAll('.rb-tab-item').forEach(t => t.classList.remove('active'));
                }
                this.classList.add('active');
                
                const tabName = this.innerText.trim();
                const container = document.getElementById('newProfileFeed');
                
                if(tabName === 'ACTIVITY') {
                    if(currentProfileUid) loadProfilePostsNew(currentProfileUid);
                } else if(tabName === 'INVENTORY' || tabName === 'SKINS') {
                    container.innerHTML = `
                        <div style="text-align:center; padding:40px; color:#64748b;">
                            <i data-lucide="lock" style="width:30px; height:30px; margin: 0 auto 10px auto; display:block; opacity:0.5;"></i>
                            <span>Inventory is private.</span>
                        </div>`;
                    if(typeof lucide !== 'undefined') lucide.createIcons();
                }
            });
        });
    }
}, 2000); // Small delay ensures DOM is fully loaded
</script>
</body>
</html>
