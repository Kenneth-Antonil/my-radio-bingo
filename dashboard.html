
<!DOCTYPE html>
<html lang="tl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DJ Master Dashboard | Live Bingo Monitor</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>

    <style>
        :root {
            --bg: #0f172a;
            --card-bg: #1e293b;
            --neon: #00f2fe;
            --warning: #f1c40f;
            --danger: #ff4757;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background: var(--bg);
            color: white;
            margin: 0;
            padding: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #334155;
            padding-bottom: 15px;
            margin-bottom: 25px;
        }

        .players-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
        }

        /* Player Card Mirror */
        .monitor-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 12px;
            border: 2px solid transparent;
            transition: 0.3s;
            position: relative;
        }

        /* Kapag malapit na mag-Bingo (4/5 numbers) */
        .monitor-card.near-bingo {
            border-color: var(--warning);
            box-shadow: 0 0 15px rgba(241, 196, 15, 0.4);
            animation: pulse 1.5s infinite;
        }

        /* Bingo Grid Mirror */
        .mini-bingo {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 3px;
            margin-top: 10px;
        }

        .m-cell {
            aspect-ratio: 1;
            background: #334155;
            border-radius: 3px;
            font-size: 0.6rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #94a3b8;
        }

        .m-cell.active {
            background: var(--neon);
            color: #000;
            font-weight: bold;
        }

        .player-info {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            margin-bottom: 5px;
        }

        .status-tag {
            font-size: 0.6rem;
            padding: 2px 6px;
            border-radius: 4px;
            background: #475569;
        }

        .near-tag { background: var(--warning); color: black; font-weight: bold; display: none; }
        .monitor-card.near-bingo .near-tag { display: inline-block; }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>üéôÔ∏è DJ Live Monitor</h1>
        <div>Players Online: <span id="pCount">0</span></div>
    </div>

    <div class="players-grid" id="mainMonitor">
        </div>

<script>
   const firebaseConfig = {
  apiKey: "AIzaSyDIAQXJ15atKJxu7PtcFL1W9JnO1N14pVs",
  authDomain: "radiobingo-9ac29.firebaseapp.com",
  databaseURL: "https://radiobingo-9ac29-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "radiobingo-9ac29",
  storageBucket: "radiobingo-9ac29.firebasestorage.app",
  messagingSenderId: "965903993397",
  appId: "1:965903993397:web:f6646fa05225f147eebf7c",
  measurementId: "G-RR2EG93C43"
};
    // 2. MONITORING
    database.ref('players').on('value', (snapshot) => {
        const players = snapshot.val();
        renderDashboard(players);
    });

    function renderDashboard(players) {
        const grid = document.getElementById('mainMonitor');
        grid.innerHTML = '';
        if (!players) return;

        let count = 0;
        for (let id in players) {
            count++;
            const p = players[id];
            const isNear = checkNearBingo(p.markedIndices); // Logic para sa 4/5

            const card = document.createElement('div');
            card.className = `monitor-card ${isNear ? 'near-bingo' : ''}`;
            
            let gridCells = '';
            // I-mirror ang 25 cells
            for(let i=0; i<25; i++) {
                const isActive = p.markedIndices && p.markedIndices.includes(i) ? 'active' : '';
                gridCells += `<div class="m-cell ${isActive}">${p.cardNumbers[i]}</div>`;
            }

            card.innerHTML = `
                <div class="player-info">
                    <strong>${p.name}</strong>
                    <span class="status-tag near-tag">WAITING 1!</span>
                </div>
                <div class="mini-bingo">${gridCells}</div>
            `;
            grid.appendChild(card);
        }
        document.getElementById('pCount').innerText = count;
    }

    // Logic para malaman kung 4 out of 5 na ang isang linya
    function checkNearBingo(marked) {
        if (!marked || marked.length < 4) return false;
        const wins = [
            [0,1,2,3,4], [5,6,7,8,9], [10,11,12,13,14], [15,16,17,18,19], [20,21,22,23,24], // Rows
            [0,5,10,15,20], [1,6,11,16,21], [2,7,12,17,22], [3,8,13,18,23], [4,9,14,19,24], // Cols
            [0,6,12,18,24], [4,8,12,16,20] // Diagonals
        ];

        for (let combo of wins) {
            let matches = combo.filter(idx => marked.includes(idx)).length;
            if (matches === 4) return true; // Muntik na!
        }
        return false;
    }
</script>
</body>
</html>
